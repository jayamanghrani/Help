AgingWithIPquery= select c.callid "TICKET NO", c.ondate "Ticket Logged Date", ce.ondate "Assigned on", mv.categoryname "Problem Category", mv.MODULENAME "Problem Type", mv.EVENTNAME "Problem Item", mv.PROBLEMSUMMARYNAME "Problem Summary", c.ERRORMESSAGE "Problem Description", c.userid "Ticket Logged UserID", um.username "Ticket Logged Username", decode (c.STATE,'11',ci.userid,'2',ci.userid,ce.userid) "Person Responsible User Id", decode (c.state,'11',ci.username,'2',ci.username,um.username) "Person Responsible UserName", decode(c.state,'11',FN_GETROLEFORUSER(ci.userid) ,'2',FN_GETROLEFORUSER(ci.userid),rolename) "Role", decode (c.state,'5',fn_pengingtowip(c.callid) ,'') "Pending to WIP",  h.hierarchy_name "Department", sc.CATEGORYNAME "Status",  mv.LOGGEDFROMCCNAME "User Office Code", mv.PRIORITYNAME "Priority", mv.SEVERITYNAME "Severity", ugp.usergrpname "Customer Group Name", cls.callclassname "Call Classification", pc.cause "SP Call Classification", round(sysdate - ce.ondate) "No of Aging Days" from call  c, tbl_call_currentinfo ci,    calltrace_ent    ce, mv_call      mv, tbl_rolemaster   rm, tbl_hierarchylevels  hl, tbl_statuscategory   sc, tbl_workflowconfig   wfc, tbl_hierarchy    h, tbl_usermaster   um, cbr_CallClassification cls, tbl_prb_cause    pc, tbl_usergroupmaster  ugp, tbl_user_usergrpassoc  uga  where c.callid = ce.callid  and ci.callid = c.callid(+)  and c.callid = mv.TICKETNO(+)  and ce.userid = ci.spuserid and um.userid=ce.userid and ce.currentown = 1  and ce.nodeid(+) = wfc.nodeid  and wfc.hierarchylevelid = hl.hierarchylevelid  and hl.roleid = rm.roleid  and h.hierarchyid = hl.hierarchyid and rm.rolename in ('TCS SP')  and sc.STATUSCATEGORYID = c.STATE and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and  ugp.usergrpid(+) = uga.usergrpid  and ci.statusid not in (2, 4) and c.causeid not in (select pc1.causeid from tbl_prb_cause pc1 where upper(pc1.cause)=upper('New Requirement'))  union  select c.callid "TICKET NO", c.ondate "Ticket Logged Date", ce.ondate "Assigned on", mv.categoryname "Problem Category", mv.MODULENAME "Problem Type", mv.EVENTNAME "Problem Item", mv.PROBLEMSUMMARYNAME "Problem Summary", c.ERRORMESSAGE "Problem Description", c.userid "Ticket Logged UserID",  um.username "Ticket Logged Username",decode (c.STATE,'11',ci.userid,'2',ci.userid,ce.userid) "Person Responsible User Id",  decode (c.state,'11',ci.username,'2',ci.username,um.username) "Person Responsible UserName",   decode(c.state,'11',FN_GETROLEFORUSER(ci.userid) ,'2',FN_GETROLEFORUSER(ci.userid),rolename) "Role", decode (c.state,'5',fn_pengingtowip(c.callid) ,'') "Pending to WIP",  h.hierarchy_name "Department", sc.CATEGORYNAME "Status", mv.LOGGEDFROMCCNAME "User Office Code", mv.PRIORITYNAME "Priority", mv.SEVERITYNAME "Severity", ugp.usergrpname "Customer Group Name", cls.callclassname "Call Classification", pc.cause "SP Call Classification", round(sysdate - ce.ondate) "No of Aging Days"   from call_ar       c, tbl_call_currentinfo_ar ci, calltrace_ent_ar    ce, mv_call_ar      mv, tbl_rolemaster   rm, tbl_hierarchylevels  hl, tbl_statuscategory   sc, tbl_workflowconfig   wfc, tbl_hierarchy    h, tbl_usermaster   um, cbr_CallClassification cls, tbl_prb_cause    pc, tbl_usergroupmaster  ugp, tbl_user_usergrpassoc  uga  where c.callid = ce.callid  and ci.callid = c.callid(+)  and c.callid = mv.TICKETNO(+)  and ce.userid = ci.spuserid and um.userid=ce.userid  and ce.currentown = 1  and ce.nodeid(+) = wfc.nodeid and wfc.hierarchylevelid = hl.hierarchylevelid  and hl.roleid = rm.roleid  and h.hierarchyid =hl.hierarchyid  and rm.rolename in ('TCS SP')  and sc.STATUSCATEGORYID = c.STATE and c.callclassid =cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) =uga.usergrpid  and ci.statusid not in (2, 4)  and c.causeid not in (select pc1.causeid from tbl_prb_cause pc1 where upper(pc1.cause)=upper('New Requirement'))

H1Query = select c.callid    "TICKET NO",  ci.spusername    "SP UserName",  h.hierarchy_name "Department"   from call         c,  tbl_call_currentinfo   ci,  calltrace_ent     ce,  mv_call      mv,  tbl_rolemaster    rm,  tbl_hierarchylevels    hl,  tbl_statuscategory     sc,  tbl_workflowconfig     wfc,  tbl_hierarchy     h,  tbl_usermaster    um,  cbr_CallClassification cls,  tbl_prb_cause     pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga where c.callid = ce.callid   and ci.callid = c.callid(+)   and c.callid = mv.TICKETNO(+)   and ce.userid = ci.spuserid   and um.userid = ce.userid    and ce.currentown = 1   and ce.nodeid(+) = wfc.nodeid   and wfc.hierarchylevelid = hl.hierarchylevelid   and hl.roleid = rm.roleid   and h.hierarchyid = hl.hierarchyid   and sc.STATUSCATEGORYID = c.STATE   and c.callclassid = cls.callclassid(+)   and c.causeid = pc.causeid(+)   and um.userid = uga.userid(+)   and ugp.usergrpid(+) = uga.usergrpid   and ci.statusid not in (2, 4)   and rm.rolename in ('TCS SP')   and sc.STATUSCATEGORYID in (12, 5)   and (pc.cause is null or pc.cause not in ('New Requirement'))   and mv.PRIORITYNAME in ('H1') union select c.callid    "TICKET NO",  ci.spusername    "SP UserName",  h.hierarchy_name "Department"  from call_ar       c,  tbl_call_currentinfo_ar ci,  calltrace_ent_ar   ce,  mv_call_ar    mv,  tbl_rolemaster     rm,  tbl_hierarchylevels     hl,  tbl_statuscategory      sc,  tbl_workflowconfig      wfc,  tbl_hierarchy      h,  tbl_usermaster     um,  cbr_CallClassification  cls,   tbl_prb_cause      pc,  tbl_usergroupmaster     ugp,  tbl_user_usergrpassoc   uga where c.callid = ce.callid    and ci.callid = c.callid(+)   and c.callid = mv.TICKETNO(+)   and ce.userid = ci.spuserid   and um.userid = ce.userid   and ce.currentown = 1   and ce.nodeid(+) = wfc.nodeid   and wfc.hierarchylevelid = hl.hierarchylevelid   and hl.roleid = rm.roleid   and h.hierarchyid = hl.hierarchyid   and sc.STATUSCATEGORYID = c.STATE   and c.callclassid = cls.callclassid(+)   and c.causeid = pc.causeid(+)    and um.userid = uga.userid(+)   and ugp.usergrpid(+) = uga.usergrpid   and ci.statusid not in (2, 4)    and rm.rolename in ('TCS SP')   and sc.STATUSCATEGORYID in (12, 5)    and (pc.cause is null or pc.cause not in ('New Requirement'))    and mv.PRIORITYNAME in ('H1')
    
NewlyOpenedTicketsQuery =   Select c.callid     "Ticket No",  ct1.ondate   "Assigned On",  c.ondate     "Ticket Logged Date", mv.categoryname  "Problem Category",  mv.MODULENAME  "Problem Type",  mv.EVENTNAME   "Problem Item",  mv.PROBLEMSUMMARYNAME "Problem Summary",  c.ERRORMESSAGE    "Problem Description",  c.userid     "Ticket Logged UserID",  cc.username    "Ticket Logged Username",  um.userid    "SP User Id",  um.username    "SP UserName",  rm1.rolename   "Role",  h.hierarchy_name    "Department",  stc.categoryname    "Status",  mv.LOGGEDFROMCCNAME   "User office Code",  mv.PRIORITYNAME  "Priority",  mv.SEVERITYNAME  "Severity",  ugp.usergrpname  "Customer Group Name",  cls.callclassname   "Call Classification",  pc.cause     "SP Call Classification"  from tbl_workflowconfig  wfc,  tbl_statuscategory  stc,  calltrace_ent  ct1,  tbl_hierarchy  h,  tbl_hierarchylevels hl1,  tbl_usermaster    um,  call     c,  mv_call    mv,  tbl_rolemaster    rm1,  cbr_CallClassification cls,  tbl_prb_cause   pc,  tbl_usergroupmaster  ugp,  tbl_user_usergrpassoc uga,  tbl_call_currentinfo cc where wfc.nodeid = ct1.nodeid   and wfc.hierarchylevelid = hl1.hierarchylevelid   and stc.statuscategoryid = c.state   and um.userid = ct1.userid   and ct1.callid = c.callid   and mv.TICKETNO = ct1.callid   and mv.TICKETNO = c.callid   and h.hierarchyid = hl1.hierarchyid   and hl1.roleid = rm1.roleid   and c.callclassid = cls.callclassid(+)   and c.causeid = pc.causeid(+)   and um.userid=uga.userid(+)    and ugp.usergrpid(+)=uga.usergrpid    and rm1.rolename in ('TCS SP')   and c.callid=cc.callid   and mv.TICKETNO=cc.callid   and ct1.calltraceid in  (Select Min(ct.calltraceid)   from call     c,      calltrace_ent  ct,      tbl_workflowconfig  wfc,      tbl_hierarchylevels hl,      tbl_rolemaster    rm  where ct.callid = c.callid    AND ct.nodeid = wfc.nodeid    and hl.roleid = rm.roleid    and rm.rolename IN ('TCS SP')    and wfc.hierarchylevelid = hl.hierarchylevelid      group by ct.callid) and ct1.ondate between to_date(?, 'dd/mm/yyyy') and       to_date(?, 'dd/mm/yyyy')                  union           Select c.callid     "Ticket No",  ct1.ondate   "Assigned On",  c.ondate     "Ticket Logged Date",  mv.categoryname  "Problem Category",  mv.MODULENAME  "Problem Type",  mv.EVENTNAME   "Problem Item",  mv.PROBLEMSUMMARYNAME "Problem Summary",  c.ERRORMESSAGE    "Problem Description",  c.userid     "Ticket Logged UserID",  cc.username    "Ticket Logged Username",  um.userid    "SP User Id",  um.username    "SP UserName",  rm1.rolename   "Role",  h.hierarchy_name    "Department",  stc.categoryname    "Status",  mv.LOGGEDFROMCCNAME   "User office Code",  mv.PRIORITYNAME  "Priority",  mv.SEVERITYNAME  "Severity",  ugp.usergrpname  "Customer Group Name",  cls.callclassname   "Call Classification",  pc.cause     "SP Call Classification"  from tbl_workflowconfig  wfc,  tbl_statuscategory  stc,  calltrace_ent_ar  ct1,  tbl_hierarchy  h,  tbl_hierarchylevels hl1,  tbl_usermaster    um,  call_ar     c,  mv_call_ar    mv,  tbl_rolemaster    rm1,  cbr_CallClassification cls,  tbl_prb_cause   pc,  tbl_usergroupmaster  ugp,  tbl_user_usergrpassoc uga,  tbl_call_currentinfo_ar cc where wfc.nodeid = ct1.nodeid   and wfc.hierarchylevelid = hl1.hierarchylevelid   and stc.statuscategoryid = c.state   and um.userid = ct1.userid   and ct1.callid = c.callid   and mv.TICKETNO = ct1.callid   and mv.TICKETNO = c.callid   and h.hierarchyid = hl1.hierarchyid   and hl1.roleid = rm1.roleid   and c.callclassid = cls.callclassid(+)   and c.causeid = pc.causeid(+)   and um.userid=uga.userid(+)    and ugp.usergrpid(+)=uga.usergrpid    and rm1.rolename in ('TCS SP')   and c.callid = cc.callid   and mv.TICKETNO = cc.callid  and ct1.calltraceid in  (Select Min(ct.calltraceid)   from call_ar     c,      calltrace_ent_ar  ct,      tbl_workflowconfig  wfc,      tbl_hierarchylevels hl,      tbl_rolemaster    rm  where ct.callid = c.callid    AND ct.nodeid = wfc.nodeid    and hl.roleid = rm.roleid    and rm.rolename IN ('TCS SP')    and wfc.hierarchylevelid = hl.hierarchylevelid  group by ct.callid) and ct1.ondate between to_date(?, 'dd/mm/yyyy') and       to_date(?, 'dd/mm/yyyy')

NewlyOpenedHOQuery =  Select c.callid              "Ticket No", ct1.ondate           "Assigned On", c.ondate              "Ticket Logged Date", mv.categoryname       "Problem Category", mv.MODULENAME         "Problem Type", mv.EVENTNAME          "Problem Item", mv.PROBLEMSUMMARYNAME "Problem Summary", c.ERRORMESSAGE        "Problem Description", c.userid              "Ticket Logged UserID", cc.username           "Ticket Logged Username", um.userid             "SP User Id", um.username           "SP UserName", rm1.rolename          "Role", h.hierarchy_name      "Department", stc.categoryname      "Status", mv.LOGGEDFROMCCNAME   "User office Code", mv.PRIORITYNAME       "Priority", mv.SEVERITYNAME       "Severity", ugp.usergrpname       "Customer Group Name", cls.callclassname     "Call Classification", pc.cause              "SP Call Classification" from tbl_workflowconfig  wfc, tbl_statuscategory  stc, calltrace_ent       ct1, tbl_hierarchy       h, tbl_hierarchylevels hl1, tbl_usermaster      um, call                c, mv_call             mv, tbl_rolemaster      rm1, cbr_CallClassification cls, tbl_prb_cause          pc, tbl_usergroupmaster    ugp, tbl_user_usergrpassoc uga, tbl_call_currentinfo cc where wfc.nodeid = ct1.nodeid and wfc.hierarchylevelid = hl1.hierarchylevelid and stc.statuscategoryid = c.state and um.userid = ct1.userid and ct1.callid = c.callid and mv.TICKETNO = ct1.callid and mv.TICKETNO = c.callid and h.hierarchyid = hl1.hierarchyid and hl1.roleid = rm1.roleid and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid=uga.userid(+)  and ugp.usergrpid(+)=uga.usergrpid  and rm1.rolename in ('Ho') and c.callid=cc.callid and mv.TICKETNO=cc.callid and ct1.calltraceid in (Select Min(ct.calltraceid)    from call                c,         calltrace_ent       ct,         tbl_workflowconfig  wfc,         tbl_hierarchylevels hl,         tbl_rolemaster      rm   where ct.callid = c.callid     AND ct.nodeid = wfc.nodeid     and hl.roleid = rm.roleid     and rm.rolename IN ('HO')     and wfc.hierarchylevelid = hl.hierarchylevelid        group by ct.callid) and ct1.ondate between to_date(?, 'dd/mm/yyyy') and                 to_date(?, 'dd/mm/yyyy')                           union                  Select c.callid              "Ticket No", ct1.ondate            "Assigned On", c.ondate              "Ticket Logged Date", mv.categoryname       "Problem Category", mv.MODULENAME         "Problem Type", mv.EVENTNAME          "Problem Item", mv.PROBLEMSUMMARYNAME "Problem Summary", c.ERRORMESSAGE        "Problem Description", c.userid              "Ticket Logged UserID", cc.username           "Ticket Logged Username", um.userid             "SP User Id", um.username           "SP UserName", rm1.rolename          "Role", h.hierarchy_name      "Department", stc.categoryname      "Status", mv.LOGGEDFROMCCNAME   "User office Code", mv.PRIORITYNAME       "Priority", mv.SEVERITYNAME       "Severity", ugp.usergrpname       "Customer Group Name", cls.callclassname     "Call Classification", pc.cause              "SP Call Classification" from tbl_workflowconfig  wfc, tbl_statuscategory  stc, calltrace_ent_ar       ct1, tbl_hierarchy       h, tbl_hierarchylevels hl1, tbl_usermaster      um, call_ar                c, mv_call_ar             mv, tbl_rolemaster      rm1, cbr_CallClassification cls, tbl_prb_cause          pc, tbl_usergroupmaster    ugp, tbl_user_usergrpassoc uga, tbl_call_currentinfo_ar cc where wfc.nodeid = ct1.nodeid and wfc.hierarchylevelid = hl1.hierarchylevelid and stc.statuscategoryid = c.state and um.userid = ct1.userid and ct1.callid = c.callid and mv.TICKETNO = ct1.callid and mv.TICKETNO = c.callid and h.hierarchyid = hl1.hierarchyid and hl1.roleid = rm1.roleid and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid=uga.userid(+)  and ugp.usergrpid(+)=uga.usergrpid  and rm1.rolename in ('HO') and c.callid = cc.callid and mv.TICKETNO = cc.callid and ct1.calltraceid in (Select Min(ct.calltraceid)    from call_ar                c,         calltrace_ent_ar       ct,         tbl_workflowconfig  wfc,         tbl_hierarchylevels hl,         tbl_rolemaster      rm   where ct.callid = c.callid     AND ct.nodeid = wfc.nodeid     and hl.roleid = rm.roleid     and rm.rolename IN ('HO')     and wfc.hierarchylevelid = hl.hierarchylevelid        group by ct.callid) and ct1.ondate between to_date(?, 'dd/mm/yyyy') and                 to_date(?, 'dd/mm/yyyy')

ReopenedQuery =  Select ct3.callid            "Ticket No", ct3.ondate            "Assign on", c.ondate              "Ticket Logged Date", mv.categoryname       "Problem Category", mv.MODULENAME         "Problem Type", mv.EVENTNAME          "Problem Item", mv.PROBLEMSUMMARYNAME "Problem Summary", c.errormessage        "Problem Description", c.userid              "Ticket Logged UserId",  cc.username           "Ticket Logged Username", ct3.userid            "SP UserID", um.username           "SP Username",           rm.rolename           "Role", h.hierarchy_name    "Department", st.categoryname      "Status",  mv.LOGGEDFROMCCNAME "User Office Code", mv.PRIORITYNAME     "Priority", mv.SEVERITYNAME     "Severity", ugp.usergrpname     "Customer Group Name", cls.callclassname   "Call Classification", pc.cause            "SP Call Classification", c.traceid         "Number of time Repoen"  from calltrace_ent          ct3, Mv_Call                mv, call                   c, cbr_CallClassification cls, tbl_prb_cause          pc, tbl_usergroupmaster    ugp, tbl_user_usergrpassoc  uga, tbl_usermaster         um, tbl_workflowconfig wfc, tbl_hierarchylevels    hl, tbl_rolemaster         rm, tbl_hierarchy          h, tbl_statuscategory     st,tbl_call_currentinfo cc where ct3.calltraceid in (Select Max(ct2.calltraceid)    from calltrace_ent ct2,                  (Select calltraceid, callid, traceid            from calltrace_ent ct1           where calltraceid in                 (Select Min(calltraceid)                    from calltrace_ent ct                   where traceid > 0                   group by callid, traceid)             and ct1.ondate between to_date(? , 'dd/mm/yyyy') and                 to_date(? , 'dd/mm/yyyy')                    ) A   where ct2.traceid = (A.traceid - 1)     and ct2.callid = a.callid   group by ct2.callid, ct2.traceid) and c.callid=cc.callid and wfc.nodeid = ct3.nodeid  and cc.sphierarchylevelid = hl.hierarchylevelid and h.hierarchyid = hl.hierarchyid and rm.roleid = hl.roleid and rm.rolename = 'TCS SP' and ct3.callid = mv.TICKETNO and c.callid = ct3.callid and ct3.userid = um.userid and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and c.state=st.statuscategoryid union  Select ct3.callid            "Ticket No", ct3.ondate            "Assign on", c.ondate              "Ticket Logged Date", mv.categoryname       "Problem Category", mv.MODULENAME         "Problem Type", mv.EVENTNAME          "Problem Item", mv.PROBLEMSUMMARYNAME "Problem Summary", c.errormessage        "Problem Description", c.userid              "Ticket Logged UserId",   cc.username           "Ticket Logged Username", ct3.userid            "SP UserID", um.username           "SP Username",        rm.rolename           "Role", h.hierarchy_name    "Department", st.categoryname      "Status",  mv.LOGGEDFROMCCNAME "User Office Code", mv.PRIORITYNAME     "Priority", mv.SEVERITYNAME     "Severity", ugp.usergrpname     "Customer Group Name", cls.callclassname   "Call Classification", pc.cause            "SP Call Classification", c.traceid         "Number of time Repoen"  from calltrace_ent_ar          ct3, Mv_Call_ar                mv, call_ar                   c, cbr_CallClassification cls, tbl_prb_cause          pc, tbl_usergroupmaster    ugp, tbl_user_usergrpassoc  uga, tbl_usermaster         um, tbl_workflowconfig wfc, tbl_hierarchylevels    hl, tbl_rolemaster         rm, tbl_hierarchy          h, tbl_statuscategory     st ,tbl_call_currentinfo_ar cc where ct3.calltraceid in (Select Max(ct2.calltraceid)    from calltrace_ent_ar ct2,                  (Select calltraceid, callid, traceid            from calltrace_ent_ar ct1           where calltraceid in                 (Select Min(calltraceid)                    from calltrace_ent_ar ct                   where traceid > 0                   group by callid, traceid)             and ct1.ondate between to_date(? , 'dd/mm/yyyy') and                 to_date(? , 'dd/mm/yyyy')                    ) A   where ct2.traceid = (A.traceid - 1)     and ct2.callid = a.callid   group by ct2.callid, ct2.traceid) and c.callid=cc.callid and wfc.nodeid = ct3.nodeid and cc.sphierarchylevelid = hl.hierarchylevelid and h.hierarchyid = hl.hierarchyid and rm.roleid = hl.roleid and rm.rolename = 'TCS SP' and ct3.callid = mv.TICKETNO and c.callid = ct3.callid and ct3.userid = um.userid and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and c.state=st.statuscategoryid

ResolvedByHoQuery =  Select ci.callid    "Ticket No", ci.solveddate   "Solved Date", ci.ondate    "Ticket logged Date", mv.categoryname    "Problem Category", mv.MODULENAME   "Problem Type", mv.EVENTNAME    "Problem Item", mv.PROBLEMSUMMARYNAME "Problem Summary", c.errormessage  "Problem Description", c.userid     "Ticket Logged UserID", ci.username     "Ticket Logged Username", ci.spuserid     "SP User Id", ci.spusername   "SP UserName", rm.rolename     "Role", h.hierarchy_name   "Department", ci.statusname   "STATUS", mv.LOGGEDFROMCCNAME   "User Office Code", mv.PRIORITYNAME    "Priority", mv.SEVERITYNAME    "Severity", ugp.usergrpname    "Customer Group Name", cls.callclassname  "Call Classification", pc.cause     "SP Call Classification" from tbl_call_currentinfo   ci, tbl_usermaster   um, tbl_hierarchylevels hl, tbl_hierarchy    h, tbl_rolemaster   rm, MV_CALL    mv, call       c, cbr_CallClassification cls, tbl_prb_cause    pc, tbl_usergroupmaster ugp, tbl_user_usergrpassoc  uga where ci.callid = mv.TICKETNO and c.callid = ci.callid and h.hierarchyid = hl.hierarchyid and ci.userid = um.userid and hl.roleid = rm.roleid and ci.sphierarchylevelid = hl.hierarchylevelid and rm.rolename = 'HO' and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and ci.solveddate between to_date(? , 'dd/mm/yyyy') and to_date(? , 'dd/mm/yyyy') and ci.statusid in (2, 4) union Select ci.callid    "Ticket No", ci.solveddate   "Solved Date", ci.ondate    "Ticket logged Date", mv.categoryname    "Problem Category", mv.MODULENAME   "Problem Type", mv.EVENTNAME    "Problem Item", mv.PROBLEMSUMMARYNAME "Problem Summary", c.errormessage  "Problem Description", c.userid     "Ticket Logged UserID", ci.username     "Ticket Logged Username", ci.spuserid     "SP User Id", ci.spusername   "SP UserName", rm.rolename     "Role", h.hierarchy_name   "Department", ci.statusname   "STATUS", mv.LOGGEDFROMCCNAME   "User Office Code", mv.PRIORITYNAME    "Priority", mv.SEVERITYNAME    "Severity", ugp.usergrpname    "Customer Group Name", cls.callclassname  "Call Classification", pc.cause     "SP Call Classification" from tbl_call_currentinfo_ar ci, tbl_usermaster    um, tbl_hierarchylevels  hl, tbl_hierarchy     h, tbl_rolemaster    rm, MV_CALL_ar     mv, call_ar     c, cbr_CallClassification  cls, tbl_prb_cause     pc, tbl_usergroupmaster  ugp, tbl_user_usergrpassoc   uga where ci.callid = mv.TICKETNO and c.callid = ci.callid and h.hierarchyid = hl.hierarchyid and ci.userid = um.userid and hl.roleid = rm.roleid and ci.sphierarchylevelid = hl.hierarchylevelid and rm.rolename = 'HO' and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and ci.solveddate between to_date(? , 'dd/mm/yyyy') and to_date(? , 'dd/mm/yyyy') and ci.statusid in (2, 4)

ResolvedByTicketsQuery =      Select ci.callid             "Ticket No", ci.solveddate         "Solved Date", ci.ondate             "Ticket logged Date", mv.categoryname       "Problem Category", mv.MODULENAME         "Problem Type", mv.EVENTNAME          "Problem Item", mv.PROBLEMSUMMARYNAME "Problem Summary", c.errormessage        "Problem Description", c.userid              "Ticket Logged UserID", ci.username           "Ticket Logged Username", ci.spuserid           "SP User Id", ci.spusername         "SP UserName", rm.rolename           "Role", h.hierarchy_name      "Department", ci.statusname         "STATUS", mv.LOGGEDFROMCCNAME   "User Office Code", mv.PRIORITYNAME       "Priority", mv.SEVERITYNAME       "Severity", ugp.usergrpname       "Customer Group Name", cls.callclassname     "Call Classification", pc.cause              "SP Call Classification" from tbl_call_currentinfo   ci, tbl_usermaster         um, tbl_hierarchylevels    hl, tbl_hierarchy          h, tbl_rolemaster         rm, MV_CALL                mv, call                   c, cbr_CallClassification cls, tbl_prb_cause          pc, tbl_usergroupmaster    ugp, tbl_user_usergrpassoc  uga where ci.callid = mv.TICKETNO and c.callid = ci.callid and h.hierarchyid = hl.hierarchyid and ci.userid = um.userid and hl.roleid = rm.roleid and ci.sphierarchylevelid = hl.hierarchylevelid and rm.rolename = 'TCS SP' and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and ci.solveddate between to_date(? , 'dd/mm/yyyy') and to_date(? , 'dd/mm/yyyy') and ci.statusid in (2, 4) union Select ci.callid             "Ticket No", ci.solveddate         "Solved Date", ci.ondate             "Ticket logged Date", mv.categoryname       "Problem Category", mv.MODULENAME         "Problem Type", mv.EVENTNAME          "Problem Item", mv.PROBLEMSUMMARYNAME "Problem Summary", c.errormessage        "Problem Description", c.userid              "Ticket Logged UserID", ci.username           "Ticket Logged Username", ci.spuserid           "SP User Id", ci.spusername         "SP UserName", rm.rolename           "Role", h.hierarchy_name      "Department", ci.statusname         "STATUS", mv.LOGGEDFROMCCNAME   "User Office Code", mv.PRIORITYNAME       "Priority", mv.SEVERITYNAME       "Severity", ugp.usergrpname       "Customer Group Name", cls.callclassname     "Call Classification", pc.cause              "SP Call Classification" from tbl_call_currentinfo_ar ci, tbl_usermaster          um, tbl_hierarchylevels     hl, tbl_hierarchy           h, tbl_rolemaster          rm, MV_CALL_ar              mv, call_ar                 c, cbr_CallClassification  cls, tbl_prb_cause           pc, tbl_usergroupmaster     ugp, tbl_user_usergrpassoc   uga where ci.callid = mv.TICKETNO and c.callid = ci.callid and h.hierarchyid = hl.hierarchyid and ci.userid = um.userid and hl.roleid = rm.roleid and ci.sphierarchylevelid = hl.hierarchylevelid and rm.rolename = 'TCS SP' and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and ci.solveddate between to_date(? , 'dd/mm/yyyy') and to_date(? , 'dd/mm/yyyy') and ci.statusid in (2, 4)

ReturnAfterClarificationQuery = select ct4.callid  "Ticket No", ct4.ondate            "Assigned on", c.ondate              "Ticket Logged Date", mv.categoryname       "Problem Category", mv.MODULENAME         "Problem Type", mv.EVENTNAME          "Problem Item", mv.PROBLEMSUMMARYNAME "Problem Summary", c.ERRORMESSAGE        "Problem Description", c.userid              "Ticket Logged UserID", ci4.username          "Ticket Logged Username", ci4.spuserid          "SP User Id", ci4.Spusername        "SP UserName", rm1.rolename          "Role", h4.hierarchy_name     "Department", ci4.statusname        "Status", mv.LOGGEDFROMCCNAME   "User office Code", mv.PRIORITYNAME       "Priority", mv.SEVERITYNAME       "Severity", ugp.usergrpname       "Customer Group Name", cls.callclassname     "Call Classification", pc.cause              "SP Call Classification" from calltrace_ent ct4, (Select min(ct2.calltraceid) as calltraceid, ct2.callid as callid    from calltrace_ent ct2,         (Select Min(ct1.calltraceid) as calltraceid, ct1.callid            from calltrace_ent ct1,                 (Select callid, calltraceid                    from calltrace_ent                   where calltraceid in                         (select Min(ct.calltraceid) as calltraceid                            from calltrace_ent       ct,                                 tbl_workflowconfig  wfc,                                 tbl_hierarchylevels hl,                                 tbl_rolemaster      rm                           where ct.nodeid = wfc.nodeid                             and rm.roleid = hl.roleid                             and hl.hierarchylevelid =                                 wfc.hierarchylevelid                             and rm.rolename = 'TCS SP'                           group by callid)) b,                 tbl_workflowconfig wfc1,                 tbl_rolemaster rm1,                 tbl_hierarchylevels hl1           where ct1.calltraceid > b.calltraceid             and hl1.hierarchylevelid = wfc1.hierarchylevelid             and rm1.roleid = hl1.roleid             and ct1.nodeid = wfc1.nodeid             and rm1.rolename not in ('TCS SP')             and b.callid = ct1.callid           group by ct1.callid) outflow,         tbl_workflowconfig wfc3,         tbl_hierarchylevels hl3,         tbl_rolemaster rm3   where ct2.calltraceid > outflow.calltraceid     and ct2.callid = outflow.callid     and wfc3.nodeid = ct2.nodeid     and wfc3.hierarchylevelid = hl3.hierarchylevelid     and rm3.roleid = hl3.roleid     and rm3.rolename in ('TCS SP')   group by ct2.callid) b,  tbl_call_currentinfo   ci4, tbl_usermaster         um4, tbl_hierarchylevels    hl4, tbl_hierarchy          h4, tbl_workflowconfig     wfc4, call                   c, mv_call                mv, tbl_rolemaster         rm1, cbr_CallClassification cls, tbl_prb_cause          pc, tbl_usergroupmaster    ugp, tbl_user_usergrpassoc uga  where b.callid = ct4.callid and b.callid = c.callid and c.callid = mv.TICKETNO and b.calltraceid = ct4.calltraceid and ct4.nodeid = wfc4.nodeid and wfc4.hierarchylevelid = hl4.hierarchylevelid and h4.hierarchyid = hl4.hierarchyid and um4.userid = ct4.userid and ct4.callid = ci4.callid and hl4.roleid = rm1.roleid and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um4.userid=uga.userid(+)  and ugp.usergrpid(+)=uga.usergrpid and ct4.ondate between to_date(? , 'dd/mm/yyyy') and to_date(? , 'dd/mm/yyyy') union select ct4.callid            "Ticket No", ct4.ondate            "Assigned on", c.ondate              "Ticket Logged Date", mv.categoryname       "Problem Category", mv.MODULENAME         "Problem Type", mv.EVENTNAME          "Problem Item", mv.PROBLEMSUMMARYNAME "Problem Summary", c.ERRORMESSAGE        "Problem Description", c.userid              "Ticket Logged UserID", ci4.username          "Ticket Logged Username", ci4.spuserid          "SP User Id", ci4.Spusername        "SP UserName", rm1.rolename          "Role", h4.hierarchy_name     "Department", ci4.statusname        "Status", mv.LOGGEDFROMCCNAME   "User office Code", mv.PRIORITYNAME       "Priority", mv.SEVERITYNAME       "Severity", ugp.usergrpname       "Customer Group Name", cls.callclassname     "Call Classification", pc.cause              "SP Call Classification" from calltrace_ent_ar ct4, (Select min(ct2.calltraceid) as calltraceid, ct2.callid as callid    from calltrace_ent_ar ct2,         (Select Min(ct1.calltraceid) as calltraceid, ct1.callid            from calltrace_ent_ar ct1,                 (Select callid, calltraceid                    from calltrace_ent_ar                   where calltraceid in                         (select Min(ct.calltraceid) as calltraceid                            from calltrace_ent_ar       ct,                                 tbl_workflowconfig  wfc,                                 tbl_hierarchylevels hl,                                 tbl_rolemaster      rm                           where ct.nodeid = wfc.nodeid                             and rm.roleid = hl.roleid                             and hl.hierarchylevelid =                                 wfc.hierarchylevelid                             and rm.rolename = 'TCS SP'                           group by callid)) b,                 tbl_workflowconfig wfc1,                 tbl_rolemaster rm1,                 tbl_hierarchylevels hl1           where ct1.calltraceid > b.calltraceid             and hl1.hierarchylevelid = wfc1.hierarchylevelid             and rm1.roleid = hl1.roleid             and ct1.nodeid = wfc1.nodeid             and rm1.rolename not in ('TCS SP')             and b.callid = ct1.callid           group by ct1.callid) outflow,         tbl_workflowconfig wfc3,         tbl_hierarchylevels hl3,         tbl_rolemaster rm3   where ct2.calltraceid > outflow.calltraceid     and ct2.callid = outflow.callid     and wfc3.nodeid = ct2.nodeid     and wfc3.hierarchylevelid = hl3.hierarchylevelid     and rm3.roleid = hl3.roleid     and rm3.rolename in ('TCS SP')   group by ct2.callid) b,  tbl_call_currentinfo_ar   ci4, tbl_usermaster         um4, tbl_hierarchylevels    hl4, tbl_hierarchy          h4, tbl_workflowconfig     wfc4, call_ar                   c, mv_call_ar                mv, tbl_rolemaster         rm1, cbr_CallClassification cls, tbl_prb_cause          pc, tbl_usergroupmaster    ugp, tbl_user_usergrpassoc uga  where b.callid = ct4.callid and b.callid = c.callid and c.callid = mv.TICKETNO and b.calltraceid = ct4.calltraceid and ct4.nodeid = wfc4.nodeid and wfc4.hierarchylevelid = hl4.hierarchylevelid and h4.hierarchyid = hl4.hierarchyid and um4.userid = ct4.userid and ct4.callid = ci4.callid and hl4.roleid = rm1.roleid and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um4.userid=uga.userid(+)  and ugp.usergrpid(+)=uga.usergrpid and ct4.ondate between to_date(? , 'dd/mm/yyyy')  and to_date(? , 'dd/mm/yyyy')

SentForClarificationQuery = Select ct2.callid            "Ticket No",  ct2.ondate            "Assign on",  c.ondate              "Ticket Logged Date",  mv.categoryname       "Problem Category",  mv.MODULENAME         "Problem Type",  mv.EVENTNAME          "Problem Item",  mv.PROBLEMSUMMARYNAME "Problem Summary",  c.errormessage        "Problem Description",  c.userid              "Ticket Logged UserId",  cc.username           "Ticket Logged Username",  ct2.userid            "SP UserID",  um.username           "SP Username",  rm1.rolename          "Role",  h1.hierarchy_name     "Department",  st.categoryname       "Status", mv.LOGGEDFROMCCNAME   "User Office Code",  mv.PRIORITYNAME       "Priority",  mv.SEVERITYNAME       "Severity",  ugp.usergrpname       "Customer Group Name",  cls.callclassname     "Call Classification",  pc.cause              "SP Call Classification"  from calltrace_ent          ct2,  tbl_workflowconfig     wfc1,  tbl_hierarchy          h1,  tbl_hierarchylevels    hl1,  tbl_rolemaster         rm1,  mv_call                mv,  call                   c,  tbl_usermaster         um,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga,  tbl_statuscategory     st,  tbl_call_currentinfo   cc  where ct2.calltraceid in  (select max(ct1.calltraceid) as calltraceid     from calltrace_ent ct1,          (select ct.calltraceid as calltraceid,                  callid,                  rm.rolename,                  h.hierarchy_name             from calltrace_ent       ct,                  tbl_workflowconfig  wfc,                  tbl_hierarchy       h,                  tbl_hierarchylevels hl,                  tbl_rolemaster      rm            where ct.nodeid = wfc.nodeid              and wfc.hierarchylevelid = hl.hierarchylevelid              and h.hierarchyid = hl.hierarchyid              and rm.roleid = hl.roleid              and rm.rolename not in ('TCS SP')              and ct.ondate between to_date(? , 'dd/mm/yyyy') and                  to_date(? , 'dd/mm/yyyy')                      ) A    where ct1.callid = A.callid      and ct1.calltraceid < A.calltraceid    group by ct1.callid)  and wfc1.nodeid = ct2.nodeid  and wfc1.hierarchylevelid = hl1.hierarchylevelid  and h1.hierarchyid = hl1.hierarchyid  and rm1.roleid = hl1.roleid  and rolename = 'TCS SP'  and c.callid = cc.callid  and mv.ticketno = cc.callid  and c.callid = ct2.callid  and ct2.userid = um.userid  and mv.TICKETNO = c.callid  and mv.TICKETNO = ct2.callid  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid  and c.state=st.statuscategoryid   union    Select ct2.callid         "Ticket No",  ct2.ondate            "Assign on",  c.ondate              "Ticket Logged Date",  mv.categoryname       "Problem Category",  mv.MODULENAME         "Problem Type",  mv.EVENTNAME          "Problem Item",  mv.PROBLEMSUMMARYNAME "Problem Summary",  c.errormessage        "Problem Description",  c.userid              "Ticket Logged UserId",  cc.username           "Ticket Logged Username",  ct2.userid            "SP UserID",  um.username           "SP Username",  rm1.rolename          "Role",  h1.hierarchy_name     "Department",  st1.categoryname       "Status",  mv.LOGGEDFROMCCNAME   "User Office Code",  mv.PRIORITYNAME       "Priority",  mv.SEVERITYNAME       "Severity",  ugp.usergrpname       "Customer Group Name",  cls.callclassname     "Call Classification",  pc.cause              "SP Call Classification"  from calltrace_ent_ar          ct2,  tbl_workflowconfig     wfc1,  tbl_hierarchy          h1,  tbl_hierarchylevels    hl1,  tbl_rolemaster         rm1,  mv_call_ar                mv,  call_ar                   c,  tbl_usermaster         um,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga,  tbl_statuscategory     st1,  tbl_call_currentinfo_ar cc  where ct2.calltraceid in  (select max(ct1.calltraceid) as calltraceid     from calltrace_ent_ar ct1,          (select ct.calltraceid as calltraceid,                  callid,                  rm.rolename,                  h.hierarchy_name             from calltrace_ent_ar       ct,                  tbl_workflowconfig  wfc,                  tbl_hierarchy       h,                  tbl_hierarchylevels hl,                  tbl_rolemaster      rm            where ct.nodeid = wfc.nodeid              and wfc.hierarchylevelid = hl.hierarchylevelid              and h.hierarchyid = hl.hierarchyid              and rm.roleid = hl.roleid              and rm.rolename not in ('TCS SP')              and ct.ondate between to_date(? , 'dd/mm/yyyy') and                  to_date(? , 'dd/mm/yyyy')                      ) A    where ct1.callid = A.callid      and ct1.calltraceid < A.calltraceid    group by ct1.callid)  and wfc1.nodeid = ct2.nodeid  and wfc1.hierarchylevelid = hl1.hierarchylevelid  and h1.hierarchyid = hl1.hierarchyid  and rm1.roleid = hl1.roleid  and rolename = 'TCS SP'  and c.callid = cc.callid  and mv.ticketno = cc.callid  and c.callid = ct2.callid  and ct2.userid = um.userid  and mv.TICKETNO = c.callid  and mv.TICKETNO = ct2.callid  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid  and c.state=st1.statuscategoryid  union  Select ct2.callid          "Ticket No",  ct2.ondate            "Assign on",  c.ondate              "Ticket Logged Date",  mv.categoryname       "Problem Category",  mv.MODULENAME         "Problem Type",  mv.EVENTNAME          "Problem Item",  mv.PROBLEMSUMMARYNAME "Problem Summary",  c.errormessage        "Problem Description",  c.userid              "Ticket Logged UserId",  cc.username           "Ticket Logged Username",  ct2.userid            "SP UserID",  um.username           "SP Username",  rm2.rolename          "Role",  h2.hierarchy_name     "Department",         st.categoryname       "Status" ,  mv.LOGGEDFROMCCNAME   "User Office Code",  mv.PRIORITYNAME       "Priority",  mv.SEVERITYNAME       "Severity",  ugp.usergrpname       "Customer Group Name",  cls.callclassname     "Call Classification",  pc.cause              "SP Call Classification"  from calltrace_ent ct2,  tbl_workflowconfig wfc2,  tbl_hierarchy h2,  tbl_hierarchylevels hl2,  tbl_rolemaster rm2,  mv_call                mv,  call                   c,  tbl_usermaster         um,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga,  tbl_statuscategory     st,  tbl_call_currentinfo   cc,  (select ct.calltraceid as calltraceid,          ct.callid,          rm.roleid,          h.hierarchyid     from calltrace_ent       ct,          tbl_workflowconfig  wfc,          tbl_hierarchylevels hl,          tbl_rolemaster      rm,          tbl_hierarchy       h    where ct.nodeid = wfc.nodeid      and rm.roleid = hl.roleid      and hl.hierarchylevelid = wfc.hierarchylevelid      and h.hierarchyid = hl.hierarchyid      and rm.rolename = 'TCS SP'      and ct.ondate between to_date(? , 'dd/mm/yyyy') and          to_date(? , 'dd/mm/yyyy')) Diff_deptrole1  where ct2.calltraceid in  (Select Max(ct1.calltraceid) as calltraceid     from calltrace_ent ct1,          (select ct.calltraceid as calltraceid,                  ct.callid,                  rm.roleid,                  h.hierarchyid             from calltrace_ent       ct,                  tbl_workflowconfig  wfc,                  tbl_hierarchylevels hl,                  tbl_rolemaster      rm,                  tbl_hierarchy       h            where ct.nodeid = wfc.nodeid              and rm.roleid = hl.roleid              and hl.hierarchylevelid = wfc.hierarchylevelid              and h.hierarchyid = hl.hierarchyid              and rm.rolename = 'TCS SP'              and ct.ondate between to_date(? , 'dd/mm/yyyy') and                  to_date(? , 'dd/mm/yyyy')) Diff_deptrole    where Diff_deptrole.callid = ct1.callid      and ct1.calltraceid < Diff_deptrole.calltraceid    group by ct1.callid)  and ct2.nodeid = wfc2.nodeid  and rm2.roleid = hl2.roleid  and hl2.hierarchylevelid = wfc2.hierarchylevelid  and h2.hierarchyid = hl2.hierarchyid  and rm2.rolename = 'TCS SP'  and c.callid = cc.callid  and mv.ticketno = cc.callid  and Diff_deptrole1.hierarchyid <> h2.hierarchyid  and Diff_deptrole1.callid = ct2.callid  and rm2.roleid = Diff_deptrole1.roleid  and c.callid = ct2.callid  and ct2.userid = um.userid  and mv.TICKETNO = c.callid  and mv.TICKETNO = ct2.callid  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid  and c.state=st.statuscategoryid  union    Select ct2.callid          "Ticket No",  ct2.ondate            "Assign on",  c.ondate              "Ticket Logged Date",  mv.categoryname       "Problem Category",  mv.MODULENAME         "Problem Type",  mv.EVENTNAME          "Problem Item",  mv.PROBLEMSUMMARYNAME "Problem Summary",  c.errormessage        "Problem Description",  c.userid              "Ticket Logged UserId",  cc.username           "Ticket Logged Username",  ct2.userid            "SP UserID",  um.username           "SP Username",  rm2.rolename          "Role",  h2.hierarchy_name     "Department",   st.categoryname       "Status",  mv.LOGGEDFROMCCNAME   "User Office Code",  mv.PRIORITYNAME       "Priority",  mv.SEVERITYNAME       "Severity",  ugp.usergrpname       "Customer Group Name",  cls.callclassname     "Call Classification",  pc.cause              "SP Call Classification"      from calltrace_ent_ar ct2,  tbl_workflowconfig wfc2,  tbl_hierarchy h2,  tbl_hierarchylevels hl2,  tbl_rolemaster rm2,  mv_call_ar                mv,  call_ar                  c,  tbl_usermaster         um,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga,  tbl_statuscategory     st,   tbl_call_currentinfo_ar cc,  (select ct.calltraceid as calltraceid,          ct.callid,          rm.roleid,          h.hierarchyid     from calltrace_ent_ar       ct,          tbl_workflowconfig  wfc,          tbl_hierarchylevels hl,          tbl_rolemaster      rm,          tbl_hierarchy       h    where ct.nodeid = wfc.nodeid      and rm.roleid = hl.roleid      and hl.hierarchylevelid = wfc.hierarchylevelid      and h.hierarchyid = hl.hierarchyid      and rm.rolename = 'TCS SP'      and ct.ondate between to_date(? , 'dd/mm/yyyy') and          to_date(? , 'dd/mm/yyyy')) Diff_deptrole1  where ct2.calltraceid in  (Select Max(ct1.calltraceid) as calltraceid     from calltrace_ent_ar ct1,          (select ct.calltraceid as calltraceid,                  ct.callid,                  rm.roleid,                  h.hierarchyid             from calltrace_ent_ar       ct,                  tbl_workflowconfig  wfc,                  tbl_hierarchylevels hl,                  tbl_rolemaster      rm,                  tbl_hierarchy       h            where ct.nodeid = wfc.nodeid              and rm.roleid = hl.roleid              and hl.hierarchylevelid = wfc.hierarchylevelid              and h.hierarchyid = hl.hierarchyid              and rm.rolename = 'TCS SP'              and ct.ondate between to_date(? , 'dd/mm/yyyy') and                  to_date(? , 'dd/mm/yyyy')) Diff_deptrole    where Diff_deptrole.callid = ct1.callid      and ct1.calltraceid < Diff_deptrole.calltraceid    group by ct1.callid)  and ct2.nodeid = wfc2.nodeid  and rm2.roleid = hl2.roleid  and hl2.hierarchylevelid = wfc2.hierarchylevelid  and h2.hierarchyid = hl2.hierarchyid  and rm2.rolename = 'TCS SP'  and c.callid = cc.callid  and mv.ticketno = cc.callid  and Diff_deptrole1.hierarchyid <> h2.hierarchyid  and Diff_deptrole1.callid = ct2.callid  and rm2.roleid = Diff_deptrole1.roleid  and c.callid = ct2.callid  and ct2.userid = um.userid  and mv.TICKETNO = c.callid  and mv.TICKETNO = ct2.callid  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid  and c.state=st.statuscategoryid
 
Reopen10To3pmQuery =  Select ct3.callid            "Ticket No",         mv.PROBLEMSUMMARYNAME "Problem Summary"     from calltrace_ent          ct3,  Mv_Call                mv,  call                   c,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga,  tbl_usermaster         um,  tbl_workflowconfig wfc,  tbl_hierarchylevels    hl,  tbl_rolemaster         rm,  tbl_hierarchy          h,  tbl_statuscategory     st,tbl_call_currentinfo cc where ct3.calltraceid in  (Select Max(ct2.calltraceid)     from calltrace_ent ct2,         (Select calltraceid, callid, traceid             from calltrace_ent ct1            where calltraceid in                  (Select Min(calltraceid)                     from calltrace_ent ct                    where traceid > 0                                      and ct.ondate  between to_date(? ,'dd/mm/yy hh24:mi:ss')             and to_date(? ,'dd/mm/yy hh24:mi:ss')                                             group by callid, traceid)          ) A    where ct2.traceid = (A.traceid - 1)      and ct2.callid = a.callid    group by ct2.callid, ct2.traceid) and c.callid=cc.callid  and wfc.nodeid = ct3.nodeid  and cc.sphierarchylevelid = hl.hierarchylevelid  and h.hierarchyid = hl.hierarchyid  and h.hierarchy_name in ('Core Insurance')  and st.STATUSCATEGORYID in (5,12,11)  and rm.roleid = hl.roleid  and rm.rolename = 'TCS SP'  and ct3.callid = mv.TICKETNO  and c.callid = ct3.callid  and ct3.userid = um.userid  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid  and c.state=st.statuscategoryid union Select ct3.callid            "Ticket No",     mv.PROBLEMSUMMARYNAME "Problem Summary" from calltrace_ent_ar          ct3,  Mv_Call_ar                mv,  call_ar                   c,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga,  tbl_usermaster         um,  tbl_workflowconfig wfc,  tbl_hierarchylevels    hl,  tbl_rolemaster         rm,  tbl_hierarchy          h,  tbl_statuscategory     st ,tbl_call_currentinfo_ar cc where ct3.calltraceid in  (Select Max(ct2.calltraceid)     from calltrace_ent_ar ct2,         (Select calltraceid, callid, traceid             from calltrace_ent_ar ct1            where calltraceid in                  (Select Min(calltraceid)                     from calltrace_ent_ar ct                    where traceid > 0                and ct.ondate  between to_date(? ,'dd/mm/yy hh24:mi:ss')             and to_date(? ,'dd/mm/yy hh24:mi:ss')                    group by callid, traceid) ) A    where ct2.traceid = (A.traceid - 1)      and ct2.callid = a.callid    group by ct2.callid, ct2.traceid) and c.callid=cc.callid  and wfc.nodeid = ct3.nodeid  and cc.sphierarchylevelid = hl.hierarchylevelid  and h.hierarchyid = hl.hierarchyid   and h.hierarchy_name in ('Core Insurance')   and st.STATUSCATEGORYID in (5,12,11)    and rm.roleid = hl.roleid  and rm.rolename = 'TCS SP'  and ct3.callid = mv.TICKETNO  and c.callid = ct3.callid  and ct3.userid = um.userid  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid  and c.state=st.statuscategoryid

updated3pmQuery = select c.callid "TICKET NO",  mv.PROBLEMSUMMARYNAME "Problem Summary" from call                   c,  tbl_call_currentinfo   ci,  calltrace_ent          ce,  mv_call                mv,  tbl_rolemaster         rm,  tbl_hierarchylevels    hl,  tbl_statuscategory     sc,  tbl_workflowconfig     wfc,  tbl_hierarchy          h,  tbl_usermaster         um,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga where c.callid = ce.callid  and ci.callid = c.callid(+)  and c.callid = mv.TICKETNO(+)  and ce.userid = ci.spuserid  and um.userid=ce.userid  and ce.currentown = 1  and ce.nodeid(+) = wfc.nodeid  and wfc.hierarchylevelid = hl.hierarchylevelid  and hl.roleid = rm.roleid  and ci.statusid in (12,5)  and h.hierarchy_name in('Core Insurance')  and h.hierarchyid = hl.hierarchyid  and rm.rolename in ('TCS SP')  and sc.STATUSCATEGORYID = c.STATE  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid  and ci.statusid not in (2, 4)  and c.ondate <   to_date(?,'dd/mm/yy hh24:mi:ss')  and c.causeid not in (select pc1.causeid from tbl_prb_cause pc1 where upper(pc1.cause)=upper('New Requirement')) union select c.callid "TICKET NO",  mv.PROBLEMSUMMARYNAME "Problem Summary" from call_ar                   c,  tbl_call_currentinfo_ar   ci,  calltrace_ent_ar          ce,  mv_call_ar                mv,  tbl_rolemaster         rm,  tbl_hierarchylevels    hl,  tbl_statuscategory     sc,  tbl_workflowconfig     wfc,  tbl_hierarchy          h,  tbl_usermaster         um,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga where c.callid = ce.callid  and ci.callid = c.callid(+)  and c.callid = mv.TICKETNO(+)  and ce.userid = ci.spuserid  and um.userid=ce.userid  and ce.currentown = 1  and ce.nodeid(+) = wfc.nodeid  and wfc.hierarchylevelid = hl.hierarchylevelid  and hl.roleid = rm.roleid  and ci.statusid in (12,5)  and h.hierarchy_name in('Core Insurance')  and h.hierarchyid = hl.hierarchyid  and rm.rolename in ('TCS SP')  and sc.STATUSCATEGORYID = c.STATE  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid  and ci.statusid not in (2, 4)  and c.ondate <   to_date(?,'dd/mm/yy hh24:mi:ss')  and c.causeid not in (select pc1.causeid from tbl_prb_cause pc1 where upper(pc1.cause)=upper('New Requirement'))

updated10amQuery  = select c.callid "TICKET NO",  mv.PROBLEMSUMMARYNAME "Problem Summary"     from call                   c,  tbl_call_currentinfo   ci,  calltrace_ent          ce,  mv_call                mv,  tbl_rolemaster         rm,  tbl_hierarchylevels    hl,  tbl_statuscategory     sc,  tbl_workflowconfig     wfc,  tbl_hierarchy          h,  tbl_usermaster         um,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga where c.callid = ce.callid and ci.callid = c.callid(+) and c.callid = mv.TICKETNO(+) and ce.userid = ci.spuserid and um.userid=ce.userid and ce.currentown = 1 and ce.nodeid(+) = wfc.nodeid and wfc.hierarchylevelid = hl.hierarchylevelid and hl.roleid = rm.roleid and ci.statusid in (11) and h.hierarchy_name in('Core Insurance') and h.hierarchyid = hl.hierarchyid and rm.rolename in ('TCS SP') and sc.STATUSCATEGORYID = c.STATE and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and ci.statusid not in (2, 4) and c.ondate <  to_date(?,'dd/mm/yy hh24:mi:ss') and c.causeid not in (select pc1.causeid from tbl_prb_cause pc1 where upper(pc1.cause)=upper('New Requirement')) union select c.callid "TICKET NO",  mv.PROBLEMSUMMARYNAME "Problem Summary"   from call_ar                   c,  tbl_call_currentinfo_ar   ci,  calltrace_ent_ar          ce,  mv_call_ar                mv,  tbl_rolemaster         rm,  tbl_hierarchylevels    hl,  tbl_statuscategory     sc,  tbl_workflowconfig     wfc,  tbl_hierarchy          h,  tbl_usermaster         um,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga where c.callid = ce.callid and ci.callid = c.callid(+) and c.callid = mv.TICKETNO(+) and ce.userid = ci.spuserid and um.userid=ce.userid and ce.currentown = 1 and ce.nodeid(+) = wfc.nodeid and wfc.hierarchylevelid = hl.hierarchylevelid and hl.roleid = rm.roleid and ci.statusid in (11) and h.hierarchy_name in('Core Insurance') and h.hierarchyid = hl.hierarchyid and rm.rolename in ('TCS SP') and sc.STATUSCATEGORYID = c.STATE and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and ci.statusid not in (2, 4) and c.ondate  < to_date(?,'dd/mm/yy hh24:mi:ss') and c.causeid not in (select pc1.causeid from tbl_prb_cause pc1 where upper(pc1.cause)=upper('New Requirement'))

Reopen3To6pmQuery = Select ct3.callid            "Ticket No",         mv.PROBLEMSUMMARYNAME "Problem Summary" from calltrace_ent          ct3,  Mv_Call                mv,  call                   c,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga,  tbl_usermaster         um,  tbl_workflowconfig wfc,  tbl_hierarchylevels    hl,  tbl_rolemaster         rm,  tbl_hierarchy          h,  tbl_statuscategory     st,tbl_call_currentinfo cc where ct3.calltraceid in  (Select Max(ct2.calltraceid)     from calltrace_ent ct2,        (Select calltraceid, callid, traceid             from calltrace_ent ct1            where calltraceid in                  (Select Min(calltraceid)                     from calltrace_ent ct                    where traceid > 0              and ct.ondate  between to_date(? ,'dd/mm/yy hh24:mi:ss')             and to_date(? ,'dd/mm/yy hh24:mi:ss')                                             group by callid, traceid)         ) A    where ct2.traceid = (A.traceid - 1)      and ct2.callid = a.callid    group by ct2.callid, ct2.traceid) and c.callid=cc.callid and wfc.nodeid = ct3.nodeid and cc.sphierarchylevelid = hl.hierarchylevelid and h.hierarchyid = hl.hierarchyid and h.hierarchy_name in ('Core Insurance') and st.STATUSCATEGORYID in (5,12,11) and rm.roleid = hl.roleid and rm.rolename = 'TCS SP' and ct3.callid = mv.TICKETNO and c.callid = ct3.callid and ct3.userid = um.userid and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and c.state=st.statuscategoryid union Select ct3.callid            "Ticket No", mv.PROBLEMSUMMARYNAME "Problem Summary" from calltrace_ent_ar          ct3,  Mv_Call_ar                mv,  call_ar                   c,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga,  tbl_usermaster         um,  tbl_workflowconfig wfc,  tbl_hierarchylevels    hl,  tbl_rolemaster         rm,  tbl_hierarchy          h,  tbl_statuscategory     st ,tbl_call_currentinfo_ar cc where ct3.calltraceid in  (Select Max(ct2.calltraceid)     from calltrace_ent_ar ct2,        (Select calltraceid, callid, traceid             from calltrace_ent_ar ct1            where calltraceid in                  (Select Min(calltraceid)                     from calltrace_ent_ar ct                    where traceid > 0                and ct.ondate  between to_date(? ,'dd/mm/yy hh24:mi:ss')             and to_date(?,'dd/mm/yy hh24:mi:ss')                    group by callid, traceid) ) A    where ct2.traceid = (A.traceid - 1)      and ct2.callid = a.callid    group by ct2.callid, ct2.traceid) and c.callid=cc.callid and wfc.nodeid = ct3.nodeid and cc.sphierarchylevelid = hl.hierarchylevelid and h.hierarchyid = hl.hierarchyid  and h.hierarchy_name in ('Core Insurance')  and st.STATUSCATEGORYID in (5,12,11)   and rm.roleid = hl.roleid and rm.rolename = 'TCS SP' and ct3.callid = mv.TICKETNO and c.callid = ct3.callid and ct3.userid = um.userid and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and c.state=st.statuscategoryid

updated_3pm_OF_3To6 =  select c.callid "TICKET NO", mv.PROBLEMSUMMARYNAME "Problem Summary" from call                   c, tbl_call_currentinfo   ci, calltrace_ent          ce, mv_call                mv, tbl_rolemaster         rm, tbl_hierarchylevels    hl, tbl_statuscategory     sc, tbl_workflowconfig     wfc, tbl_hierarchy          h, tbl_usermaster         um, cbr_CallClassification cls, tbl_prb_cause          pc, tbl_usergroupmaster    ugp, tbl_user_usergrpassoc  uga where c.callid = ce.callid and ci.callid = c.callid(+) and c.callid = mv.TICKETNO(+) and ce.userid = ci.spuserid and um.userid=ce.userid and ce.currentown = 1 and ce.nodeid(+) = wfc.nodeid and wfc.hierarchylevelid = hl.hierarchylevelid and hl.roleid = rm.roleid and ci.statusid in (11) and h.hierarchy_name in('Core Insurance') and h.hierarchyid = hl.hierarchyid and rm.rolename in ('TCS SP') and sc.STATUSCATEGORYID = c.STATE and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and ci.statusid not in (2, 4) and c.ondate < /*  between to_date('13-07-08 15:00:00','dd/mm/yy hh24:mi:ss') and to_date*/ to_date(?,'dd/mm/yy hh24:mi:ss') and c.causeid not in (select pc1.causeid from tbl_prb_cause pc1 where upper(pc1.cause)=upper('New Requirement')) union select c.callid "TICKET NO", mv.PROBLEMSUMMARYNAME "Problem Summary"   from call_ar                   c,    tbl_call_currentinfo_ar   ci, calltrace_ent_ar          ce, mv_call_ar                mv, tbl_rolemaster         rm, tbl_hierarchylevels    hl, tbl_statuscategory     sc, tbl_workflowconfig     wfc, tbl_hierarchy          h, tbl_usermaster         um, cbr_CallClassification cls, tbl_prb_cause          pc, tbl_usergroupmaster    ugp, tbl_user_usergrpassoc  uga  where c.callid = ce.callid and ci.callid = c.callid(+) and c.callid = mv.TICKETNO(+) and ce.userid = ci.spuserid and um.userid=ce.userid and ce.currentown = 1 and ce.nodeid(+) = wfc.nodeid and wfc.hierarchylevelid = hl.hierarchylevelid and hl.roleid = rm.roleid and ci.statusid in (11) and h.hierarchy_name in('Core Insurance') and h.hierarchyid = hl.hierarchyid  and rm.rolename in ('TCS SP') and sc.STATUSCATEGORYID = c.STATE and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and ci.statusid not in (2, 4) and c.ondate  < /*between to_date('13-07-08 15:00:00','dd/mm/yy hh24:mi:ss') and to_date*/ to_date(?,'dd/mm/yy hh24:mi:ss') and c.causeid not in (select pc1.causeid from tbl_prb_cause pc1 where upper(pc1.cause)=upper('New Requirement'))      
      
updated_6pm_OF_3To6 = select c.callid "TICKET NO",  mv.PROBLEMSUMMARYNAME "Problem Summary" from call                   c,  tbl_call_currentinfo   ci,  calltrace_ent          ce,  mv_call                mv,  tbl_rolemaster         rm,  tbl_hierarchylevels    hl,  tbl_statuscategory     sc,  tbl_workflowconfig     wfc,  tbl_hierarchy          h,  tbl_usermaster         um,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga where c.callid = ce.callid  and ci.callid = c.callid(+)  and c.callid = mv.TICKETNO(+)  and ce.userid = ci.spuserid  and um.userid=ce.userid  and ce.currentown = 1  and ce.nodeid(+) = wfc.nodeid  and wfc.hierarchylevelid = hl.hierarchylevelid  and hl.roleid = rm.roleid  and ci.statusid in (12,5)  and h.hierarchy_name in('Core Insurance')  and h.hierarchyid = hl.hierarchyid  and rm.rolename in ('TCS SP')  and sc.STATUSCATEGORYID = c.STATE  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid  and ci.statusid not in (2, 4)  and c.ondate </* between to_date('13-07-08 18:00:00','dd/mm/yy hh24:mi:ss')  and*/   to_date(?,'dd/mm/yy hh24:mi:ss')  and c.causeid not in (select pc1.causeid from tbl_prb_cause pc1 where upper(pc1.cause)=upper('New Requirement')) union select c.callid "TICKET NO",  mv.PROBLEMSUMMARYNAME "Problem Summary" from call_ar                   c,  tbl_call_currentinfo_ar   ci,  calltrace_ent_ar          ce,  mv_call_ar                mv,  tbl_rolemaster         rm,  tbl_hierarchylevels    hl,  tbl_statuscategory     sc,  tbl_workflowconfig     wfc,  tbl_hierarchy          h,  tbl_usermaster         um,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga where c.callid = ce.callid  and ci.callid = c.callid(+)  and c.callid = mv.TICKETNO(+)  and ce.userid = ci.spuserid  and um.userid=ce.userid  and ce.currentown = 1  and ce.nodeid(+) = wfc.nodeid  and wfc.hierarchylevelid = hl.hierarchylevelid  and hl.roleid = rm.roleid  and ci.statusid in (12,5)  and h.hierarchy_name in('Core Insurance')  and h.hierarchyid = hl.hierarchyid  and rm.rolename in ('TCS SP')  and sc.STATUSCATEGORYID = c.STATE  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid  and ci.statusid not in (2, 4)  and c.ondate </* between to_date('13-07-08 17:00:00','dd/mm/yy hh24:mi:ss')  and*/   to_date(?,'dd/mm/yy hh24:mi:ss')  and c.causeid not in (select pc1.causeid from tbl_prb_cause pc1 where upper(pc1.cause)=upper('New Requirement'))

ResolvedByHO_OFWeekly = Select c.callid     "Ticket No",  ci.solveddate "Solved Date", (select min(ondate) from calltrace_ent ce,tbl_workflowconfig wfc where ce.nodeid = wfc.nodeid and callid = c.callid and wfc.hierarchylevelid = ci.sphierarchylevelid and traceid = c.traceid) "Assigned Date",  c.ondate      "Ticket logged Date",  ci.closeddate    "Closed Date",         mv.categoryname       "Problem Category",  mv.MODULENAME         "Problem Type",  mv.EVENTNAME          "Problem Item",  mv.PROBLEMSUMMARYNAME "Problem Summary",  c.errormessage        "Problem Description",  c.userid              "Ticket Logged UserID",  um.username           "Ticket Logged Username",  ci.spuserid           "SP User Id",  ci.spusername         "SP UserName",  rm.rolename           "Role",  h.hierarchy_name      "Department",  ci.statusname         "STATUS",  mv.LOGGEDFROMCCNAME   "User Office Code",  mv.PRIORITYNAME       "Priority",  mv.SEVERITYNAME       "Severity",  ugp.usergrpname       "Customer Group Name",  cls.callclassname     "Call Classification",  pc.cause              "SP Call Classification" from tbl_call_currentinfo   ci,  tbl_usermaster         um,  tbl_hierarchylevels    hl,  tbl_hierarchy          h,  tbl_rolemaster         rm,  MV_CALL                mv,  call                   c,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga where ci.callid = mv.TICKETNO  and c.callid = ci.callid  and h.hierarchyid = hl.hierarchyid  and ci.userid = um.userid  and hl.roleid = rm.roleid  and ci.sphierarchylevelid = hl.hierarchylevelid  and rm.rolename = 'HO'  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid and ci.solveddate between to_date(? ,'dd/MM/yyyy') and to_date(? ,'dd/MM/yyyy')  and ci.statusid in (2, 4)      union    Select c.callid     "Ticket No",  ci.solveddate "Solved Date", (select min(ondate) from calltrace_ent_ar ce,tbl_workflowconfig wfc where ce.nodeid = wfc.nodeid and callid = c.callid and wfc.hierarchylevelid = ci.sphierarchylevelid and traceid = c.traceid) "Assigned Date",  c.ondate      "Ticket logged Date",  ci.closeddate    "Closed Date",         mv.categoryname       "Problem Category",  mv.MODULENAME         "Problem Type",  mv.EVENTNAME          "Problem Item",  mv.PROBLEMSUMMARYNAME "Problem Summary",  c.errormessage        "Problem Description",  c.userid              "Ticket Logged UserID",  um.username           "Ticket Logged Username",  ci.spuserid           "SP User Id",  ci.spusername         "SP UserName",  rm.rolename           "Role",  h.hierarchy_name      "Department",  ci.statusname         "STATUS",  mv.LOGGEDFROMCCNAME   "User Office Code",  mv.PRIORITYNAME       "Priority",  mv.SEVERITYNAME       "Severity",  ugp.usergrpname       "Customer Group Name",  cls.callclassname     "Call Classification",  pc.cause              "SP Call Classification" from tbl_call_currentinfo_ar   ci,  tbl_usermaster         um,  tbl_hierarchylevels    hl,  tbl_hierarchy          h,  tbl_rolemaster         rm,  MV_CALL_ar                mv,  call_ar                   c,  cbr_CallClassification cls,  tbl_prb_cause          pc,  tbl_usergroupmaster    ugp,  tbl_user_usergrpassoc  uga where ci.callid = mv.TICKETNO  and c.callid = ci.callid  and h.hierarchyid = hl.hierarchyid  and ci.userid = um.userid  and hl.roleid = rm.roleid  and ci.sphierarchylevelid = hl.hierarchylevelid  and rm.rolename = 'HO'  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid  and ci.solveddate between to_date(? ,'dd/MM/yyyy') and to_date(? ,'dd/MM/yyyy')  and ci.statusid in (2, 4)

ResolvedByTCS_OFWeekly = Select c.callid     "Ticket No",    ci.solveddate "Solved Date",  (select min(ondate) from calltrace_ent ce,tbl_workflowconfig wfc where ce.nodeid = wfc.nodeid and callid = c.callid and wfc.hierarchylevelid = ci.sphierarchylevelid and traceid = c.traceid) "Assigned Date",    c.ondate      "Ticket logged Date",    ci.closeddate    "Closed Date",           mv.categoryname       "Problem Category",    mv.MODULENAME         "Problem Type",    mv.EVENTNAME          "Problem Item",    mv.PROBLEMSUMMARYNAME "Problem Summary",    c.errormessage        "Problem Description",    c.userid              "Ticket Logged UserID",    um.username           "Ticket Logged Username",    ci.spuserid           "SP User Id",    ci.spusername         "SP UserName",    rm.rolename           "Role",    h.hierarchy_name      "Department",    ci.statusname         "STATUS",    mv.LOGGEDFROMCCNAME   "User Office Code",    mv.PRIORITYNAME       "Priority",    mv.SEVERITYNAME       "Severity",    ugp.usergrpname       "Customer Group Name",    cls.callclassname     "Call Classification",    pc.cause              "SP Call Classification" from tbl_call_currentinfo   ci,    tbl_usermaster         um,    tbl_hierarchylevels    hl,    tbl_hierarchy          h,    tbl_rolemaster         rm,    MV_CALL                mv,    call                   c,    cbr_CallClassification cls,    tbl_prb_cause          pc,    tbl_usergroupmaster    ugp,    tbl_user_usergrpassoc  uga where ci.callid = mv.TICKETNO  and c.callid = ci.callid  and h.hierarchyid = hl.hierarchyid  and ci.userid = um.userid  and hl.roleid = rm.roleid  and ci.sphierarchylevelid = hl.hierarchylevelid  and rm.rolename = 'TCS SP'  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid  and ci.solveddate between to_date(? ,'dd/MM/yyyy') and to_date(? ,'dd/MM/yyyy')  and ci.statusid in (2, 4)      union    Select c.callid     "Ticket No",    ci.solveddate "Solved Date",  (select min(ondate) from calltrace_ent_ar ce,tbl_workflowconfig wfc where ce.nodeid = wfc.nodeid and callid = c.callid and wfc.hierarchylevelid = ci.sphierarchylevelid and traceid = c.traceid) "Assigned Date",    c.ondate      "Ticket logged Date",    ci.closeddate    "Closed Date",           mv.categoryname       "Problem Category",    mv.MODULENAME         "Problem Type",    mv.EVENTNAME          "Problem Item",    mv.PROBLEMSUMMARYNAME "Problem Summary",    c.errormessage        "Problem Description",    c.userid              "Ticket Logged UserID",    um.username           "Ticket Logged Username",    ci.spuserid           "SP User Id",    ci.spusername         "SP UserName",    rm.rolename           "Role",    h.hierarchy_name      "Department",    ci.statusname         "STATUS",    mv.LOGGEDFROMCCNAME   "User Office Code",    mv.PRIORITYNAME       "Priority",    mv.SEVERITYNAME       "Severity",    ugp.usergrpname       "Customer Group Name",    cls.callclassname     "Call Classification",    pc.cause              "SP Call Classification"  from tbl_call_currentinfo_ar   ci,    tbl_usermaster         um,    tbl_hierarchylevels    hl,    tbl_hierarchy          h,    tbl_rolemaster         rm,    MV_CALL_ar                mv,    call_ar                   c,    cbr_CallClassification cls,    tbl_prb_cause          pc,    tbl_usergroupmaster    ugp,    tbl_user_usergrpassoc  uga where ci.callid = mv.TICKETNO  and c.callid = ci.callid  and h.hierarchyid = hl.hierarchyid  and ci.userid = um.userid  and hl.roleid = rm.roleid  and ci.sphierarchylevelid = hl.hierarchylevelid  and rm.rolename = 'TCS SP'  and c.callclassid = cls.callclassid(+)  and c.causeid = pc.causeid(+)  and um.userid = uga.userid(+)  and ugp.usergrpid(+) = uga.usergrpid  and ci.solveddate between to_date(? ,'dd/MM/yyyy') and to_date(? ,'dd/MM/yyyy')  and ci.statusid in (2, 4)

SentForClarificationHO_NEW_OFWeekly = select za.callid "TicketNo",  za.Assignon "Assign on",  za.ondate "Ticket Logged Date",  za.categoryname "Problem Category",  za.MODULENAME "Problem Type",  za.EVENTNAME "Problem Item",  za.PROBLEMSUMMARYNAME "Problem Summary",  za.errormessage "Problem Description",  za.userid "Ticket Logged UserId",  za.username "Ticket Logged Username",  zc.spuserid "SP UserID",  zc.spusername "SP Username",  zr.rolename "Role",  zh.hierarchy_name "Department",  za.Status,  za.LOGGEDFROMCCNAME "User Office Code",  za.PRIORITYNAME "Priority",  za.SEVERITYNAME "Severity",  za.usergrpname "Customer Group Name",  za.callclassname "Call Classification",  za.cause "SP Call Classification"  from (Select ct2.callid         ,          ct2.ondate          as  Assignon,          c.ondate              ,          mv.categoryname       ,          mv.MODULENAME         ,          mv.EVENTNAME          ,          mv.PROBLEMSUMMARYNAME ,          c.errormessage        ,          c.userid              ,          cc.username           ,          ct2.userid        "Spuser"    ,          um.username         "spusername"  ,          rm1.rolename          ,          h1.hierarchy_name     ,          st.categoryname       as Status,          mv.LOGGEDFROMCCNAME   ,          mv.PRIORITYNAME       ,          mv.SEVERITYNAME       ,          ugp.usergrpname       ,          cls.callclassname     ,          pc.cause                        from calltrace_ent          ct2,          tbl_workflowconfig     wfc1,          tbl_hierarchy          h1,          tbl_hierarchylevels    hl1,          tbl_rolemaster         rm1,          mv_call                mv,          call                   c,          tbl_usermaster         um,          cbr_CallClassification cls,          tbl_prb_cause          pc,          tbl_usergroupmaster    ugp,          tbl_user_usergrpassoc  uga,          tbl_statuscategory     st,          tbl_call_currentinfo   cc    where ct2.calltraceid in          (select max(ct1.calltraceid) as calltraceid             from calltrace_ent ct1,                  (select ct.calltraceid as calltraceid,                          callid,                          rm.rolename,                          h.hierarchy_name                     from calltrace_ent       ct,                          tbl_workflowconfig  wfc,                          tbl_hierarchy       h,                          tbl_hierarchylevels hl,                          tbl_rolemaster      rm                    where ct.nodeid = wfc.nodeid                      and wfc.hierarchylevelid = hl.hierarchylevelid                      and h.hierarchyid = hl.hierarchyid                      and rm.roleid = hl.roleid                      and rm.rolename not in ('HO')                      and ct.ondate between                          to_date(? , 'dd/mm/yyyy') and                          to_date(? , 'dd/mm/yyyy')                                      ) A            where ct1.callid = A.callid              and ct1.calltraceid < A.calltraceid            group by ct1.callid)      and wfc1.nodeid = ct2.nodeid      and wfc1.hierarchylevelid = hl1.hierarchylevelid      and h1.hierarchyid = hl1.hierarchyid      and rm1.roleid = hl1.roleid      and rolename = 'HO'      and c.callid = cc.callid      and mv.ticketno = cc.callid      and c.callid = ct2.callid      and ct2.userid = um.userid      and mv.TICKETNO = c.callid      and mv.TICKETNO = ct2.callid      and c.callclassid = cls.callclassid(+)      and c.causeid = pc.causeid(+)      and um.userid = uga.userid(+)      and ugp.usergrpid(+) = uga.usergrpid      and c.state = st.statuscategoryid) za,  tbl_call_currentinfo zc,  tbl_hierarchylevels zl,  tbl_hierarchy zh,  tbl_rolemaster zr  where za.callid = zc.callid  and zc.sphierarchylevelid = zl.hierarchylevelid  and zl.hierarchyid = zh.hierarchyid  and zl.roleid = zr.roleid  union  select za.callid "TicketNo",  za.Assignon "Assign on",  za.ondate "Ticket Logged Date",  za.categoryname "Problem Category",  za.MODULENAME "Problem Type",  za.EVENTNAME "Problem Item",  za.PROBLEMSUMMARYNAME "Problem Summary",  za.errormessage "Problem Description",  za.userid "Ticket Logged UserId",  za.username "Ticket Logged Username",  zc.spuserid "SP UserID",  zc.spusername "SP Username",  zr.rolename "Role",  zh.hierarchy_name "Department",  za.Status,  za.LOGGEDFROMCCNAME "User Office Code",  za.PRIORITYNAME "Priority",  za.SEVERITYNAME "Severity",  za.usergrpname "Customer Group Name",  za.callclassname "Call Classification",  za.cause "SP Call Classification"  from (Select ct2.callid ,          ct2.ondate       as     Assignon,          c.ondate           ,          mv.categoryname    ,          mv.MODULENAME      ,          mv.EVENTNAME        ,          mv.PROBLEMSUMMARYNAME ,          c.errormessage        ,          c.userid              ,          cc.username           ,          ct2.userid            "SP UserID",          um.username           "SP Username",          rm1.rolename          ,          h1.hierarchy_name     ,          st1.categoryname      as Status,          mv.LOGGEDFROMCCNAME   ,          mv.PRIORITYNAME       ,          mv.SEVERITYNAME       ,          ugp.usergrpname       ,          cls.callclassname     ,          pc.cause                      from calltrace_ent_ar        ct2,          tbl_workflowconfig      wfc1,          tbl_hierarchy           h1,          tbl_hierarchylevels     hl1,          tbl_rolemaster          rm1,          mv_call_ar              mv,          call_ar                 c,          tbl_usermaster          um,          cbr_CallClassification  cls,          tbl_prb_cause           pc,          tbl_usergroupmaster     ugp,          tbl_user_usergrpassoc   uga,          tbl_statuscategory      st1,          tbl_call_currentinfo_ar cc    where ct2.calltraceid in          (select max(ct1.calltraceid) as calltraceid             from calltrace_ent_ar ct1,                  (select ct.calltraceid as calltraceid,                          callid,                          rm.rolename,                          h.hierarchy_name                     from calltrace_ent_ar    ct,                          tbl_workflowconfig  wfc,                          tbl_hierarchy       h,                          tbl_hierarchylevels hl,                          tbl_rolemaster      rm                    where ct.nodeid = wfc.nodeid                      and wfc.hierarchylevelid = hl.hierarchylevelid                      and h.hierarchyid = hl.hierarchyid                      and rm.roleid = hl.roleid                      and rm.rolename not in ('HO')                      and ct.ondate between                          to_date(? , 'dd/mm/yyyy') and                          to_date(? , 'dd/mm/yyyy')                                      ) A            where ct1.callid = A.callid              and ct1.calltraceid < A.calltraceid            group by ct1.callid)      and wfc1.nodeid = ct2.nodeid      and wfc1.hierarchylevelid = hl1.hierarchylevelid      and h1.hierarchyid = hl1.hierarchyid      and rm1.roleid = hl1.roleid      and rolename = 'HO'      and c.callid = cc.callid      and mv.ticketno = cc.callid      and c.callid = ct2.callid      and ct2.userid = um.userid      and mv.TICKETNO = c.callid      and mv.TICKETNO = ct2.callid      and c.callclassid = cls.callclassid(+)      and c.causeid = pc.causeid(+)      and um.userid = uga.userid(+)      and ugp.usergrpid(+) = uga.usergrpid      and c.state = st1.statuscategoryid) za,  tbl_call_currentinfo_ar zc,  tbl_hierarchylevels zl,  tbl_hierarchy zh,  tbl_rolemaster zr   where za.callid = zc.callid  and zc.sphierarchylevelid = zl.hierarchylevelid  and zl.hierarchyid = zh.hierarchyid  and zl.roleid = zr.roleid   union   select za.callid "TicketNo",  za.Assignon "Assign on",  za.ondate "Ticket Logged Date",  za.categoryname "Problem Category",  za.MODULENAME "Problem Type",  za.EVENTNAME "Problem Item",  za.PROBLEMSUMMARYNAME "Problem Summary",  za.errormessage "Problem Description",  za.userid "Ticket Logged UserId",  za.username "Ticket Logged Username",  zc.spuserid "SP UserID",  zc.spusername "SP Username",  zr.rolename "Role",  zh.hierarchy_name "Department",  za.Status,  za.LOGGEDFROMCCNAME "User Office Code",  za.PRIORITYNAME "Priority",  za.SEVERITYNAME "Severity",  za.usergrpname "Customer Group Name",  za.callclassname "Call Classification",  za.cause "SP Call Classification"  from (Select ct2.callid        ,          ct2.ondate   as Assignon     ,          c.ondate          ,          mv.categoryname   ,          mv.MODULENAME     ,          mv.EVENTNAME       ,          mv.PROBLEMSUMMARYNAME ,          c.errormessage        ,          c.userid              ,          cc.username           ,          ct2.userid            "SP UserID",          um.username           "SP Username",          rm2.rolename          ,          h2.hierarchy_name     ,          st.categoryname       as Status,          mv.LOGGEDFROMCCNAME   ,          mv.PRIORITYNAME       ,          mv.SEVERITYNAME       ,          ugp.usergrpname       ,          cls.callclassname     ,          pc.cause                      from calltrace_ent ct2,          tbl_workflowconfig wfc2,          tbl_hierarchy h2,          tbl_hierarchylevels hl2,          tbl_rolemaster rm2,          mv_call mv,          call c,          tbl_usermaster um,          cbr_CallClassification cls,          tbl_prb_cause pc,          tbl_usergroupmaster ugp,          tbl_user_usergrpassoc uga,          tbl_statuscategory st,          tbl_call_currentinfo cc,          (select ct.calltraceid as calltraceid,                  ct.callid,                  rm.roleid,                  h.hierarchyid             from calltrace_ent       ct,                  tbl_workflowconfig  wfc,                  tbl_hierarchylevels hl,                  tbl_rolemaster      rm,                  tbl_hierarchy       h            where ct.nodeid = wfc.nodeid              and rm.roleid = hl.roleid              and hl.hierarchylevelid = wfc.hierarchylevelid              and h.hierarchyid = hl.hierarchyid              and rm.rolename = 'HO'              and ct.ondate between to_date(? , 'dd/mm/yyyy') and                  to_date(? , 'dd/mm/yyyy')) Diff_deptrole1    where ct2.calltraceid in          (Select Max(ct1.calltraceid) as calltraceid             from calltrace_ent ct1,                  (select ct.calltraceid as calltraceid,                          ct.callid,                          rm.roleid,                          h.hierarchyid                     from calltrace_ent       ct,                          tbl_workflowconfig  wfc,                          tbl_hierarchylevels hl,                          tbl_rolemaster      rm,                          tbl_hierarchy       h                    where ct.nodeid = wfc.nodeid                      and rm.roleid = hl.roleid                      and hl.hierarchylevelid = wfc.hierarchylevelid                      and h.hierarchyid = hl.hierarchyid                      and rm.rolename = 'HO'                      and ct.ondate between                          to_date(? , 'dd/mm/yyyy') and                          to_date(? , 'dd/mm/yyyy')) Diff_deptrole            where Diff_deptrole.callid = ct1.callid              and ct1.calltraceid < Diff_deptrole.calltraceid            group by ct1.callid)      and ct2.nodeid = wfc2.nodeid      and rm2.roleid = hl2.roleid      and hl2.hierarchylevelid = wfc2.hierarchylevelid      and h2.hierarchyid = hl2.hierarchyid      and rm2.rolename = 'HO'      and c.callid = cc.callid      and mv.ticketno = cc.callid      and Diff_deptrole1.hierarchyid <> h2.hierarchyid      and Diff_deptrole1.callid = ct2.callid      and rm2.roleid = Diff_deptrole1.roleid      and c.callid = ct2.callid      and ct2.userid = um.userid      and mv.TICKETNO = c.callid      and mv.TICKETNO = ct2.callid      and c.callclassid = cls.callclassid(+)      and c.causeid = pc.causeid(+)      and um.userid = uga.userid(+)      and ugp.usergrpid(+) = uga.usergrpid      and c.state = st.statuscategoryid) za,  tbl_call_currentinfo zc,  tbl_hierarchylevels zl,  tbl_hierarchy zh,  tbl_rolemaster zr   where za.callid = zc.callid  and zc.sphierarchylevelid = zl.hierarchylevelid  and zl.hierarchyid = zh.hierarchyid  and zl.roleid = zr.roleid  union  select za.callid "TicketNo",  za.Assignon "Assign on",  za.ondate "Ticket Logged Date",  za.categoryname "Problem Category",  za.MODULENAME "Problem Type",  za.EVENTNAME "Problem Item",  za.PROBLEMSUMMARYNAME "Problem Summary",  za.errormessage "Problem Description",  za.userid "Ticket Logged UserId",  za.username "Ticket Logged Username",  zc.spuserid "SP UserID",  zc.spusername "SP Username",  zr.rolename "Role",  zh.hierarchy_name "Department",  za.Status,  za.LOGGEDFROMCCNAME "User Office Code",  za.PRIORITYNAME "Priority",  za.SEVERITYNAME "Severity",  za.usergrpname "Customer Group Name",  za.callclassname "Call Classification",  za.cause "SP Call Classification"  from (Select ct2.callid      ,          ct2.ondate         as   Assignon,          c.ondate             ,          mv.categoryname      ,          mv.MODULENAME        ,          mv.EVENTNAME         ,          mv.PROBLEMSUMMARYNAME ,          c.errormessage        ,          c.userid              ,          cc.username           ,          ct2.userid            "SP UserID",          um.username           "SP Username",          rm2.rolename          ,          h2.hierarchy_name     ,          st.categoryname        as Status,          mv.LOGGEDFROMCCNAME   ,          mv.PRIORITYNAME       ,          mv.SEVERITYNAME       ,          ugp.usergrpname       ,          cls.callclassname     ,          pc.cause                      from calltrace_ent_ar ct2,          tbl_workflowconfig wfc2,          tbl_hierarchy h2,          tbl_hierarchylevels hl2,          tbl_rolemaster rm2,          mv_call_ar mv,          call_ar c,          tbl_usermaster um,          cbr_CallClassification cls,          tbl_prb_cause pc,          tbl_usergroupmaster ugp,          tbl_user_usergrpassoc uga,          tbl_statuscategory st,          tbl_call_currentinfo_ar cc,          (select ct.calltraceid as calltraceid,                  ct.callid,                  rm.roleid,                  h.hierarchyid             from calltrace_ent_ar    ct,                  tbl_workflowconfig  wfc,                  tbl_hierarchylevels hl,                  tbl_rolemaster      rm,                  tbl_hierarchy       h            where ct.nodeid = wfc.nodeid              and rm.roleid = hl.roleid              and hl.hierarchylevelid = wfc.hierarchylevelid              and h.hierarchyid = hl.hierarchyid              and rm.rolename = 'HO'              and ct.ondate between to_date(? , 'dd/mm/yyyy') and                  to_date(? , 'dd/mm/yyyy')) Diff_deptrole1    where ct2.calltraceid in          (Select Max(ct1.calltraceid) as calltraceid             from calltrace_ent_ar ct1,                  (select ct.calltraceid as calltraceid,                          ct.callid,                          rm.roleid,                          h.hierarchyid                     from calltrace_ent_ar    ct,                          tbl_workflowconfig  wfc,                          tbl_hierarchylevels hl,                          tbl_rolemaster      rm,                          tbl_hierarchy       h                    where ct.nodeid = wfc.nodeid                      and rm.roleid = hl.roleid                      and hl.hierarchylevelid = wfc.hierarchylevelid                      and h.hierarchyid = hl.hierarchyid                      and rm.rolename = 'HO'                      and ct.ondate between                          to_date(? , 'dd/mm/yyyy') and                          to_date(? , 'dd/mm/yyyy')) Diff_deptrole            where Diff_deptrole.callid = ct1.callid              and ct1.calltraceid < Diff_deptrole.calltraceid            group by ct1.callid)      and ct2.nodeid = wfc2.nodeid      and rm2.roleid = hl2.roleid      and hl2.hierarchylevelid = wfc2.hierarchylevelid      and h2.hierarchyid = hl2.hierarchyid      and rm2.rolename = 'HO'      and c.callid = cc.callid      and mv.ticketno = cc.callid      and Diff_deptrole1.hierarchyid <> h2.hierarchyid      and Diff_deptrole1.callid = ct2.callid      and rm2.roleid = Diff_deptrole1.roleid      and c.callid = ct2.callid      and ct2.userid = um.userid      and mv.TICKETNO = c.callid      and mv.TICKETNO = ct2.callid      and c.callclassid = cls.callclassid(+)      and c.causeid = pc.causeid(+)      and um.userid = uga.userid(+)      and ugp.usergrpid(+) = uga.usergrpid      and c.state = st.statuscategoryid) za,  tbl_call_currentinfo_ar zc,  tbl_hierarchylevels zl,  tbl_hierarchy zh,  tbl_rolemaster zr   where za.callid = zc.callid  and zc.sphierarchylevelid = zl.hierarchylevelid  and zl.hierarchyid = zh.hierarchyid  and zl.roleid = zr.roleid

SentForClarificationTCS_NEW_OFWeekly =  select za.callid "TicketNo",   za.Assignon "Assign on",   za.ondate "Ticket Logged Date",   za.categoryname "Problem Category",   za.MODULENAME "Problem Type",   za.EVENTNAME "Problem Item",   za.PROBLEMSUMMARYNAME "Problem Summary",   za.errormessage "Problem Description",   za.userid "Ticket Logged UserId",   za.username "Ticket Logged Username",   zc.spuserid "SP UserID",   zc.spusername "SP Username",   zr.rolename "Role",   zh.hierarchy_name "Department",   za.Status,   za.LOGGEDFROMCCNAME "User Office Code",   za.PRIORITYNAME "Priority",   za.SEVERITYNAME "Severity",   za.usergrpname "Customer Group Name",   za.callclassname "Call Classification",   za.cause "SP Call Classification"  from (Select ct2.callid,           ct2.ondate as Assignon,           c.ondate,           mv.categoryname,           mv.MODULENAME,           mv.EVENTNAME,           mv.PROBLEMSUMMARYNAME,           c.errormessage,           c.userid,           cc.username,           ct2.userid as SPUserID,           um.username as SPUsername,           cc.spuserid,           cc.spusername,           rm1.rolename,           h1.hierarchy_name,           st.categoryname as Status,           mv.LOGGEDFROMCCNAME,           mv.PRIORITYNAME,           mv.SEVERITYNAME,           ugp.usergrpname,           cls.callclassname,           pc.cause             from calltrace_ent          ct2,           tbl_workflowconfig     wfc1,           tbl_hierarchy          h1,           tbl_hierarchylevels    hl1,           tbl_rolemaster         rm1,           mv_call                mv,           call                   c,           tbl_usermaster         um,           cbr_CallClassification cls,           tbl_prb_cause          pc,           tbl_usergroupmaster    ugp,           tbl_user_usergrpassoc  uga,           tbl_statuscategory     st,           tbl_call_currentinfo   cc     where ct2.calltraceid in           (select max(ct1.calltraceid) as calltraceid              from calltrace_ent ct1,                   (select ct.calltraceid as calltraceid,                           callid,                           rm.rolename,                           h.hierarchy_name                      from calltrace_ent       ct,                           tbl_workflowconfig  wfc,                           tbl_hierarchy       h,                           tbl_hierarchylevels hl,                           tbl_rolemaster      rm                     where ct.nodeid = wfc.nodeid                       and wfc.hierarchylevelid = hl.hierarchylevelid                       and h.hierarchyid = hl.hierarchyid                       and rm.roleid = hl.roleid                       and rm.rolename not in ('TCS SP')                       and ct.ondate between                           to_date(? , 'dd/mm/yyyy') and                           to_date(? , 'dd/mm/yyyy')                                        ) A             where ct1.callid = A.callid               and ct1.calltraceid < A.calltraceid             group by ct1.callid)       and wfc1.nodeid = ct2.nodeid       and wfc1.hierarchylevelid = hl1.hierarchylevelid       and h1.hierarchyid = hl1.hierarchyid       and rm1.roleid = hl1.roleid       and rolename = 'TCS SP'       and c.callid = cc.callid       and mv.ticketno = cc.callid       and c.callid = ct2.callid       and ct2.userid = um.userid       and mv.TICKETNO = c.callid       and mv.TICKETNO = ct2.callid       and c.callclassid = cls.callclassid(+)       and c.causeid = pc.causeid(+)       and um.userid = uga.userid(+)       and ugp.usergrpid(+) = uga.usergrpid       and c.state = st.statuscategoryid) za,   tbl_call_currentinfo zc,   tbl_hierarchylevels zl,   tbl_hierarchy zh,   tbl_rolemaster zr   where za.callid = zc.callid   and zc.sphierarchylevelid = zl.hierarchylevelid   and zl.hierarchyid = zh.hierarchyid   and zl.roleid = zr.roleid  union  select za.callid             "TicketNo",   za.Assignon           "Assign on",   za.ondate             "Ticket Logged Date",   za.categoryname       "Problem Category",   za.MODULENAME         "Problem Type",   za.EVENTNAME          "Problem Item",   za.PROBLEMSUMMARYNAME "Problem Summary",   za.errormessage       "Problem Description",   za.userid             "Ticket Logged UserId",   za.username           "Ticket Logged Username",   zc.spuserid           "SP UserID",   zc.spusername         "SP Username",   zr.rolename           "Role",   zh.hierarchy_name     "Department",   za.Status             "Status",   za.LOGGEDFROMCCNAME   "User Office Code",   za.PRIORITYNAME       "Priority",   za.SEVERITYNAME       "Severity",   za.usergrpname        "Customer Group Name",   za.callclassname      "Call Classification",   za.cause              "SP Call Classification"    from (Select ct2.callid,           ct2.ondate as Assignon,           c.ondate,           mv.categoryname,           mv.MODULENAME,           mv.EVENTNAME,           mv.PROBLEMSUMMARYNAME,           c.errormessage,           c.userid,           cc.username,           ct2.userid as SPUserID1,           um.username as SPUsername,           cc.spuserid,           cc.spusername,           rm1.rolename,           h1.hierarchy_name,           st1.categoryname as Status,           mv.LOGGEDFROMCCNAME,           mv.PRIORITYNAME,           mv.SEVERITYNAME,           ugp.usergrpname,           cls.callclassname,           pc.cause          from calltrace_ent_ar        ct2,           tbl_workflowconfig      wfc1,           tbl_hierarchy           h1,           tbl_hierarchylevels     hl1,           tbl_rolemaster          rm1,           mv_call_ar              mv,           call_ar                 c,           tbl_usermaster          um,           cbr_CallClassification  cls,           tbl_prb_cause           pc,           tbl_usergroupmaster     ugp,           tbl_user_usergrpassoc   uga,           tbl_statuscategory      st1,           tbl_call_currentinfo_ar cc     where ct2.calltraceid in           (select max(ct1.calltraceid) as calltraceid              from calltrace_ent_ar ct1,                   (select ct.calltraceid as calltraceid,                           callid,                           rm.rolename,                           h.hierarchy_name                      from calltrace_ent_ar    ct,                           tbl_workflowconfig  wfc,                           tbl_hierarchy       h,                           tbl_hierarchylevels hl,                           tbl_rolemaster      rm                     where ct.nodeid = wfc.nodeid                       and wfc.hierarchylevelid = hl.hierarchylevelid                       and h.hierarchyid = hl.hierarchyid                       and rm.roleid = hl.roleid                       and rm.rolename not in ('TCS SP')                       and ct.ondate between                           to_date(? , 'dd/mm/yyyy') and                           to_date(? , 'dd/mm/yyyy')                                        ) A             where ct1.callid = A.callid               and ct1.calltraceid < A.calltraceid             group by ct1.callid)       and wfc1.nodeid = ct2.nodeid       and wfc1.hierarchylevelid = hl1.hierarchylevelid       and h1.hierarchyid = hl1.hierarchyid       and rm1.roleid = hl1.roleid       and rolename = 'TCS SP'       and c.callid = cc.callid       and mv.ticketno = cc.callid       and c.callid = ct2.callid       and ct2.userid = um.userid       and mv.TICKETNO = c.callid       and mv.TICKETNO = ct2.callid       and c.callclassid = cls.callclassid(+)       and c.causeid = pc.causeid(+)       and um.userid = uga.userid(+)       and ugp.usergrpid(+) = uga.usergrpid       and c.state = st1.statuscategoryid) za,   tbl_call_currentinfo_ar zc,   tbl_hierarchylevels zl,   tbl_hierarchy zh,   tbl_rolemaster zr   where za.callid = zc.callid   and zc.sphierarchylevelid = zl.hierarchylevelid   and zl.hierarchyid = zh.hierarchyid   and zl.roleid = zr.roleid  union  select za.callid             "TicketNo",   za.Assignon           "Assign on",   za.ondate             "Ticket Logged Date",   za.categoryname       "Problem Category",   za.MODULENAME         "Problem Type",   za.EVENTNAME          "Problem Item",   za.PROBLEMSUMMARYNAME "Problem Summary",   za.errormessage       "Problem Description",   za.userid             "Ticket Logged UserId",   za.username           "Ticket Logged Username",   zc.spuserid           "SP UserID",   zc.spusername         "SP Username",   zr.rolename           "Role",   zh.hierarchy_name     "Department",   za.Status             "Status",   za.LOGGEDFROMCCNAME   "User Office Code",   za.PRIORITYNAME       "Priority",   za.SEVERITYNAME       "Severity",   za.usergrpname        "Customer Group Name",   za.callclassname      "Call Classification",   za.cause              "SP Call Classification"    from (Select ct2.callid,           ct2.ondate as Assignon,           c.ondate,           mv.categoryname,           mv.MODULENAME,           mv.EVENTNAME,           mv.PROBLEMSUMMARYNAME,           c.errormessage,           c.userid,           cc.username,           ct2.userid "SP UserID1",           um.username "SP Username",           cc.spuserid,           cc.spusername,           rm2.rolename,           h2.hierarchy_name,           st.categoryname as Status,           mv.LOGGEDFROMCCNAME,           mv.PRIORITYNAME,           mv.SEVERITYNAME,           ugp.usergrpname,           cls.callclassname,           pc.cause          from calltrace_ent ct2,           tbl_workflowconfig wfc2,           tbl_hierarchy h2,           tbl_hierarchylevels hl2,           tbl_rolemaster rm2,           mv_call mv,           call c,           tbl_usermaster um,           cbr_CallClassification cls,           tbl_prb_cause pc,           tbl_usergroupmaster ugp,           tbl_user_usergrpassoc uga,           tbl_statuscategory st,           tbl_call_currentinfo cc,           (select ct.calltraceid as calltraceid,                   ct.callid,                   rm.roleid,                   h.hierarchyid              from calltrace_ent       ct,                   tbl_workflowconfig  wfc,                   tbl_hierarchylevels hl,                   tbl_rolemaster      rm,                   tbl_hierarchy       h             where ct.nodeid = wfc.nodeid               and rm.roleid = hl.roleid               and hl.hierarchylevelid = wfc.hierarchylevelid               and h.hierarchyid = hl.hierarchyid               and rm.rolename = 'TCS SP'               and ct.ondate between to_date(? , 'dd/mm/yyyy') and                   to_date(? , 'dd/mm/yyyy')) Diff_deptrole1     where ct2.calltraceid in           (Select Max(ct1.calltraceid) as calltraceid              from calltrace_ent ct1,                   (select ct.calltraceid as calltraceid,                           ct.callid,                           rm.roleid,                           h.hierarchyid                      from calltrace_ent       ct,                           tbl_workflowconfig  wfc,                           tbl_hierarchylevels hl,                           tbl_rolemaster      rm,                           tbl_hierarchy       h                     where ct.nodeid = wfc.nodeid                       and rm.roleid = hl.roleid                       and hl.hierarchylevelid = wfc.hierarchylevelid                       and h.hierarchyid = hl.hierarchyid                       and rm.rolename = 'TCS SP'                       and ct.ondate between                           to_date(? , 'dd/mm/yyyy') and                           to_date(? , 'dd/mm/yyyy')) Diff_deptrole             where Diff_deptrole.callid = ct1.callid               and ct1.calltraceid < Diff_deptrole.calltraceid             group by ct1.callid)       and ct2.nodeid = wfc2.nodeid       and rm2.roleid = hl2.roleid       and hl2.hierarchylevelid = wfc2.hierarchylevelid       and h2.hierarchyid = hl2.hierarchyid       and rm2.rolename = 'TCS SP'       and c.callid = cc.callid       and mv.ticketno = cc.callid       and Diff_deptrole1.hierarchyid <> h2.hierarchyid       and Diff_deptrole1.callid = ct2.callid       and rm2.roleid = Diff_deptrole1.roleid       and c.callid = ct2.callid       and ct2.userid = um.userid       and mv.TICKETNO = c.callid       and mv.TICKETNO = ct2.callid       and c.callclassid = cls.callclassid(+)       and c.causeid = pc.causeid(+)       and um.userid = uga.userid(+)       and ugp.usergrpid(+) = uga.usergrpid       and c.state = st.statuscategoryid) za,   tbl_call_currentinfo zc,   tbl_hierarchylevels zl,   tbl_hierarchy zh,   tbl_rolemaster zr   where za.callid = zc.callid   and zc.sphierarchylevelid = zl.hierarchylevelid   and zl.hierarchyid = zh.hierarchyid   and zl.roleid = zr.roleid  union   select za.callid             "TicketNo",   za.Assignon           "Assign on",   za.ondate             "Ticket Logged Date",   za.categoryname       "Problem Category",   za.MODULENAME         "Problem Type",   za.EVENTNAME          "Problem Item",   za.PROBLEMSUMMARYNAME "Problem Summary",   za.errormessage       "Problem Description",   za.userid             "Ticket Logged UserId",   za.username           "Ticket Logged Username",   zc.spuserid           "SP UserID",   zc.spusername         "SP Username",   zr.rolename           "Role",   zh.hierarchy_name     "Department",   za.Status             "Status",   za.LOGGEDFROMCCNAME   "User Office Code",   za.PRIORITYNAME       "Priority",   za.SEVERITYNAME       "Severity",   za.usergrpname        "Customer Group Name",   za.callclassname      "Call Classification",   za.cause              "SP Call Classification"   from (Select ct2.callid,           ct2.ondate as Assignon,           c.ondate,           mv.categoryname,           mv.MODULENAME,           mv.EVENTNAME,           mv.PROBLEMSUMMARYNAME,           c.errormessage,           c.userid,           cc.username,           ct2.userid "SP UserID1",           um.username "SP Username",           cc.spuserid,           cc.spusername,           rm2.rolename,           h2.hierarchy_name,           st.categoryname as Status,           mv.LOGGEDFROMCCNAME,           mv.PRIORITYNAME,           mv.SEVERITYNAME,           ugp.usergrpname,           cls.callclassname,           pc.cause          from calltrace_ent_ar ct2,           tbl_workflowconfig wfc2,           tbl_hierarchy h2,           tbl_hierarchylevels hl2,           tbl_rolemaster rm2,           mv_call_ar mv,           call_ar c,           tbl_usermaster um,           cbr_CallClassification cls,           tbl_prb_cause pc,           tbl_usergroupmaster ugp,           tbl_user_usergrpassoc uga,           tbl_statuscategory st,           tbl_call_currentinfo_ar cc,           (select ct.calltraceid as calltraceid,                   ct.callid,                   rm.roleid,                   h.hierarchyid              from calltrace_ent_ar    ct,                   tbl_workflowconfig  wfc,                   tbl_hierarchylevels hl,                   tbl_rolemaster      rm,                   tbl_hierarchy       h             where ct.nodeid = wfc.nodeid               and rm.roleid = hl.roleid               and hl.hierarchylevelid = wfc.hierarchylevelid               and h.hierarchyid = hl.hierarchyid               and rm.rolename = 'TCS SP'               and ct.ondate between to_date(? , 'dd/mm/yyyy') and                   to_date(? , 'dd/mm/yyyy')) Diff_deptrole1     where ct2.calltraceid in           (Select Max(ct1.calltraceid) as calltraceid              from calltrace_ent_ar ct1,                   (select ct.calltraceid as calltraceid,                           ct.callid,                           rm.roleid,                           h.hierarchyid                      from calltrace_ent_ar    ct,                           tbl_workflowconfig  wfc,                           tbl_hierarchylevels hl,                           tbl_rolemaster      rm,                           tbl_hierarchy       h                     where ct.nodeid = wfc.nodeid                       and rm.roleid = hl.roleid                       and hl.hierarchylevelid = wfc.hierarchylevelid                       and h.hierarchyid = hl.hierarchyid                       and rm.rolename = 'TCS SP'                       and ct.ondate between                           to_date(? , 'dd/mm/yyyy') and                           to_date(? , 'dd/mm/yyyy')) Diff_deptrole             where Diff_deptrole.callid = ct1.callid               and ct1.calltraceid < Diff_deptrole.calltraceid             group by ct1.callid)       and ct2.nodeid = wfc2.nodeid       and rm2.roleid = hl2.roleid       and hl2.hierarchylevelid = wfc2.hierarchylevelid       and h2.hierarchyid = hl2.hierarchyid       and rm2.rolename = 'TCS SP'       and c.callid = cc.callid       and mv.ticketno = cc.callid       and Diff_deptrole1.hierarchyid <> h2.hierarchyid       and Diff_deptrole1.callid = ct2.callid       and rm2.roleid = Diff_deptrole1.roleid       and c.callid = ct2.callid       and ct2.userid = um.userid       and mv.TICKETNO = c.callid       and mv.TICKETNO = ct2.callid       and c.callclassid = cls.callclassid(+)       and c.causeid = pc.causeid(+)       and um.userid = uga.userid(+)       and ugp.usergrpid(+) = uga.usergrpid       and c.state = st.statuscategoryid) za,   tbl_call_currentinfo_ar zc,   tbl_hierarchylevels zl,   tbl_hierarchy zh,   tbl_rolemaster zr   where za.callid = zc.callid   and zc.sphierarchylevelid = zl.hierarchylevelid   and zl.hierarchyid = zh.hierarchyid   and zl.roleid = zr.roleid 


select c.callid "TICKET NO", mv.PROBLEMSUMMARYNAME "Problem Summary"    from call                   c, tbl_call_currentinfo   ci, calltrace_ent          ce, mv_call                mv, tbl_rolemaster         rm, tbl_hierarchylevels    hl, tbl_statuscategory     sc, tbl_workflowconfig     wfc, tbl_hierarchy          h, tbl_usermaster         um, cbr_CallClassification cls, tbl_prb_cause          pc, tbl_usergroupmaster    ugp, tbl_user_usergrpassoc  uga  where c.callid = ce.callid and ci.callid = c.callid(+) and c.callid = mv.TICKETNO(+) and ce.userid = ci.spuserid and um.userid=ce.userid and ce.currentown = 1 and ce.nodeid(+) = wfc.nodeid and wfc.hierarchylevelid = hl.hierarchylevelid and hl.roleid = rm.roleid and ci.statusid in (11) and h.hierarchy_name in('Core Insurance') and h.hierarchyid = hl.hierarchyid and rm.rolename in ('TCS SP') and sc.STATUSCATEGORYID = c.STATE and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and ci.statusid not in (2, 4) and c.ondate < /*  between to_date(?,'dd/mm/yy hh24:mi:ss') and to_date*/ to_date('04-04-18 15:00:10','dd/mm/yy hh24:mi:ss') and c.causeid not in (select pc1.causeid from tbl_prb_cause pc1 where upper(pc1.cause)=upper('New Requirement'))  union select c.callid "TICKET NO", mv.PROBLEMSUMMARYNAME "Problem Summary"   from call_ar                   c,    tbl_call_currentinfo_ar   ci, calltrace_ent_ar          ce, mv_call_ar                mv, tbl_rolemaster         rm, tbl_hierarchylevels    hl, tbl_statuscategory     sc, tbl_workflowconfig     wfc, tbl_hierarchy          h, tbl_usermaster         um, cbr_CallClassification cls, tbl_prb_cause          pc, tbl_usergroupmaster    ugp, tbl_user_usergrpassoc  uga  where c.callid = ce.callid and ci.callid = c.callid(+) and c.callid = mv.TICKETNO(+) and ce.userid = ci.spuserid and um.userid=ce.userid and ce.currentown = 1 and ce.nodeid(+) = wfc.nodeid and wfc.hierarchylevelid = hl.hierarchylevelid and hl.roleid = rm.roleid and ci.statusid in (11) and h.hierarchy_name in('Core Insurance') and h.hierarchyid = hl.hierarchyid  and rm.rolename in ('TCS SP') and sc.STATUSCATEGORYID = c.STATE and c.callclassid = cls.callclassid(+) and c.causeid = pc.causeid(+) and um.userid = uga.userid(+) and ugp.usergrpid(+) = uga.usergrpid and ci.statusid not in (2, 4) and c.ondate  < /*between to_date(?,'dd/mm/yy hh24:mi:ss') and to_date*/ to_date(?,'dd/mm/yy hh24:mi:ss') and c.causeid not in (select pc1.causeid from tbl_prb_cause pc1 where upper(pc1.cause)=upper('New Requirement'));    
DRIVERNAME =oracle.jdbc.driver.OracleDriver
URL =jdbc:oracle:thin:@10.115.20.12:1521:niaccmd
PASSWORD =ccm
USERNAME =nia_ccm
      